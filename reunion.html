<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <title>Spring 94 Connect da Dots - In the Newz</title>
  
  <!-- EmailJS SDK -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script type="text/javascript">
    (function(){
      emailjs.init({
        publicKey: "goJO7RR3HruRFPa20",
      });
    })();
  </script>
  
  <style>
    :root {
      --primary-color: #d32f2f;
      --primary-light: #f06d6d;
      --primary-dark: #b22222;
      --secondary-color: #ff6f61;
      --background: #f8f9fa;
      --card-bg: #ffffff;
      --text-primary: #2c3e50;
      --text-secondary: #7f8c8d;
      --border-color: #e0e0e0;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.15);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: var(--text-primary);
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }

    /* Modern polka dots background */
    .polka-dots {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background:
        radial-gradient(circle, rgba(211, 47, 47, 0.05) 10%, transparent 10%),
        radial-gradient(circle, rgba(211, 47, 47, 0.05) 10%, transparent 10%);
      background-size: 30px 30px;
      background-position: 0 0, 15px 15px;
      z-index: -1;
      pointer-events: none;
    }

    /* Container */
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Header */
    header {
      text-align: center;
      padding: 60px 20px 40px;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
      color: white;
      border-radius: 0 0 30px 30px;
      box-shadow: var(--shadow-lg);
      margin-bottom: 40px;
    }

    h1 {
      font-size: clamp(2rem, 5vw, 3.5rem);
      font-weight: 700;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
      animation: fadeInDown 0.8s ease-out;
    }

    .subtitle {
      font-size: 1.2rem;
      opacity: 0.95;
      animation: fadeInUp 0.8s ease-out;
    }

    /* Countdown Timer */
    .countdown-container {
      margin-top: 20px;
      padding: 20px;
      background: rgba(255, 255, 255, 0.15);
      border-radius: 15px;
      backdrop-filter: blur(10px);
      display: inline-block;
    }

    .countdown-title {
      font-size: 1rem;
      margin-bottom: 10px;
      opacity: 0.9;
      font-weight: 500;
    }

    .countdown-timer {
      display: flex;
      gap: 15px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .countdown-item {
      text-align: center;
      min-width: 70px;
    }

    .countdown-number {
      font-size: 2rem;
      font-weight: 700;
      display: block;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    .countdown-label {
      font-size: 0.8rem;
      opacity: 0.9;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    /* Navigation Tabs */
    .nav-tabs {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
      margin-bottom: 30px;
      padding: 0 20px;
    }

    .nav-tab {
      padding: 12px 24px;
      background: var(--card-bg);
      border: 2px solid var(--border-color);
      border-radius: 25px;
      cursor: pointer;
      transition: var(--transition);
      font-weight: 600;
      color: var(--text-primary);
      box-shadow: var(--shadow);
    }

    .nav-tab:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
      border-color: var(--primary-color);
    }

    .nav-tab.active {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }

    /* Card Sections */
    .section {
      background: var(--card-bg);
      border-radius: 20px;
      padding: 30px;
      margin-bottom: 30px;
      box-shadow: var(--shadow);
      transition: var(--transition);
      animation: fadeIn 0.6s ease-out;
    }

    .section:hover {
      box-shadow: var(--shadow-lg);
      transform: translateY(-2px);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      cursor: pointer;
      user-select: none;
    }

    .section-title {
      font-size: 1.8rem;
      color: var(--primary-dark);
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .toggle-icon {
      font-size: 1.2rem;
      transition: transform 0.3s ease;
      color: var(--primary-color);
    }

    .toggle-icon.expanded {
      transform: rotate(90deg);
    }

    .section-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.4s ease-out;
    }

    .section-content.expanded {
      max-height: 5000px;
    }

    /* Contact Cards */
    .contacts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .contact-card {
      background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
      border: 2px solid var(--border-color);
      border-radius: 15px;
      padding: 20px;
      transition: var(--transition);
      position: relative;
    }

    .contact-card:hover {
      border-color: var(--primary-color);
      box-shadow: var(--shadow);
      transform: translateY(-3px);
    }

    .contact-name {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--primary-dark);
      margin-bottom: 10px;
    }

    .contact-info {
      color: var(--text-secondary);
      margin-bottom: 5px;
      font-size: 0.95rem;
    }

    .contact-email {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 600;
      transition: var(--transition);
    }

    .contact-email:hover {
      color: var(--primary-light);
      text-decoration: underline;
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 24px;
      border: none;
      border-radius: 25px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
      font-size: 1rem;
    }

    .btn-primary {
      background: linear-gradient(135deg, #DAA520 0%, #FFD700 100%);
      color: #8B0000;
      box-shadow: 0 4px 15px rgba(218, 165, 32, 0.3);
      font-weight: 700;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(218, 165, 32, 0.4);
      background: linear-gradient(135deg, #B8860B 0%, #DAA520 100%);
    }

    .btn-secondary {
      background: white;
      color: var(--primary-color);
      border: 2px solid var(--primary-color);
    }

    .btn-secondary:hover {
      background: var(--primary-color);
      color: white;
    }

    .btn-small {
      padding: 8px 16px;
      font-size: 0.9rem;
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(5px);
      z-index: 1000;
      animation: fadeIn 0.3s ease-out;
    }

    .modal.active {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .modal-content {
      background: white;
      border-radius: 20px;
      padding: 40px;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--shadow-lg);
      animation: slideUp 0.4s ease-out;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .modal-title {
      font-size: 2rem;
      color: var(--primary-dark);
      font-weight: 700;
    }

    .close-btn {
      background: none;
      border: none;
      font-size: 2rem;
      cursor: pointer;
      color: var(--text-secondary);
      transition: var(--transition);
      padding: 0;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }

    .close-btn:hover {
      background: var(--background);
      color: var(--primary-color);
      transform: rotate(90deg);
    }

    /* Form Styles */
    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .form-input {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid var(--border-color);
      border-radius: 10px;
      font-size: 1rem;
      transition: var(--transition);
      font-family: inherit;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(211, 47, 47, 0.1);
    }

    textarea.form-input {
      resize: vertical;
      min-height: 100px;
    }

    /* Photo Gallery */
    .photo-links {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .photo-link-card {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%);
      color: white;
      padding: 30px;
      border-radius: 15px;
      text-align: center;
      transition: var(--transition);
      cursor: pointer;
      text-decoration: none;
      display: block;
    }

    .photo-link-card:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: var(--shadow-lg);
    }

    .photo-link-title {
      font-size: 1.3rem;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .photo-link-icon {
      font-size: 3rem;
      margin-bottom: 15px;
    }

    /* Trip Proposals */
    .trip-card {
      background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);
      border: 2px solid var(--border-color);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 20px;
      transition: var(--transition);
    }

    .trip-card:hover {
      border-color: var(--primary-color);
      box-shadow: var(--shadow);
    }

    .trip-card.highlight {
      border-color: var(--primary-color);
      background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%);
    }

    .trip-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--primary-dark);
      margin-bottom: 15px;
    }

    .trip-links {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 15px;
    }

    /* Alert/Info Box */
    .info-box {
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      border-left: 4px solid #2196f3;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
    }

    .warning-box {
      background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
      border-left: 4px solid #ff9800;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
    }

    /* Animations */
    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideUp {
      from {
        transform: translateY(50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }

      header {
        padding: 40px 20px 30px;
        border-radius: 0 0 20px 20px;
      }

      .section {
        padding: 20px;
        border-radius: 15px;
      }

      .section-title {
        font-size: 1.4rem;
      }

      .modal-content {
        padding: 25px;
      }

      .contacts-grid {
        grid-template-columns: 1fr;
      }

      .nav-tabs {
        gap: 8px;
      }

      .nav-tab {
        padding: 10px 16px;
        font-size: 0.9rem;
      }
      
      /* Make buttons smaller on mobile */
      .btn,
      button[type="submit"],
      button[type="button"] {
        padding: 10px 16px !important;
        font-size: 0.95rem !important;
      }
      
      /* Specific adjustments for large buttons */
      button[style*="padding: 15px"],
      a[style*="padding: 15px 30px"] {
        padding: 10px 20px !important;
        font-size: 1rem !important;
      }
      
      /* Fix text overflow in form sections */
      input, textarea, select, .info-box, p {
        word-wrap: break-word;
        overflow-wrap: break-word;
        max-width: 100%;
        box-sizing: border-box;
      }
      
      /* Ensure form containers don't overflow */
      .subsection-content {
        overflow-x: hidden;
      }
      
      /* Make sure grid layouts stack properly */
      div[style*="grid-template-columns"] {
        grid-template-columns: 1fr !important;
      }
    }
    
    /* Extra small devices (phones, 480px and down) */
    @media (max-width: 480px) {
      /* Reduce all font sizes significantly for phones */
      body {
        font-size: 0.85rem;
        line-height: 1.5;
      }
      
      h1 {
        font-size: 1.5rem !important;
      }
      
      h2, .section-title {
        font-size: 1.2rem !important;
      }
      
      h3, .subsection-title {
        font-size: 1.1rem !important;
      }
      
      h4 {
        font-size: 1rem !important;
      }
      
      h5 {
        font-size: 0.9rem !important;
      }
      
      p, li, div {
        font-size: 0.85rem !important;
      }
      
      /* Form elements */
      input, textarea, select {
        font-size: 0.85rem !important;
        padding: 8px !important;
      }
      
      label {
        font-size: 0.85rem !important;
      }
      
      /* Buttons */
      .btn, button {
        font-size: 0.85rem !important;
        padding: 8px 14px !important;
      }
      
      /* Info boxes and notes */
      .info-box {
        font-size: 0.8rem !important;
        padding: 10px !important;
      }
      
      /* Subsection headers */
      .subsection-header {
        padding: 10px !important;
      }
      
      /* Reduce spacing */
      .section {
        padding: 15px !important;
      }
      
      .trip-card {
        padding: 12px !important;
        margin-bottom: 12px !important;
      }
      
      /* Header subtitle */
      .subtitle {
        font-size: 0.9rem !important;
      }
      
      /* Quick links at top */
      header a, header button {
        font-size: 0.75rem !important;
        padding: 5px 10px !important;
      }
    }

    /* Utility Classes */
    .text-center {
      text-align: center;
    }

    .mt-20 {
      margin-top: 20px;
    }

    .mb-20 {
      margin-bottom: 20px;
    }

    .hidden {
      display: none;
    }

    /* Loading State */
    .loading {
      text-align: center;
      padding: 40px;
      color: var(--text-secondary);
    }

    .spinner {
      border: 3px solid var(--border-color);
      border-top: 3px solid var(--primary-color);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Action Buttons */
    .action-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 20px;
    }

    .edit-btn, .delete-btn {
      padding: 6px 12px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 0.85rem;
      font-weight: 600;
      transition: var(--transition);
    }

    .edit-btn {
      background: #4caf50;
      color: white;
    }

    .edit-btn:hover {
      background: #45a049;
    }

    .delete-btn {
      background: #f44336;
      color: white;
    }

    .delete-btn:hover {
      background: #da190b;
    }

    /* Subsection collapsible styles */
    .subsection-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      padding: 15px;
      background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
      border-radius: 10px;
      margin-bottom: 10px;
      transition: var(--transition);
      border: 2px solid var(--border-color);
    }

    .subsection-header:hover {
      border-color: var(--primary-color);
      background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%);
    }

    .subsection-title {
      font-size: 1.3rem;
      color: var(--primary-dark);
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .subsection-toggle {
      font-size: 1rem;
      transition: transform 0.3s ease;
      color: var(--primary-color);
    }

    .subsection-toggle.expanded {
      transform: rotate(90deg);
    }

    .subsection-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1),
                  opacity 0.3s ease-out,
                  transform 0.3s ease-out;
      opacity: 0;
      transform: translateY(-10px);
    }

    .subsection-content.expanded {
      max-height: 5000px;
      margin-bottom: 20px;
      opacity: 1;
      transform: translateY(0);
    }
    
    /* Smooth rotation for toggle icons */
    .subsection-toggle {
      transition: transform 0.3s ease;
      display: inline-block;
    }
    
    .subsection-toggle.expanded {
      transform: rotate(90deg);
    }
    
    /* Card hover effects */
    .trip-card {
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }
    
    .trip-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }
    
    /* Button animations */
    .btn {
      transition: all 0.3s ease;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }
    
    .btn:active {
      transform: translateY(0);
    }

    /* Custom scrollbar styling for better visibility */
    .subsection-content::-webkit-scrollbar {
      width: 12px;
    }
    
    .subsection-content::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
      border: 1px solid #e0e0e0;
    }
    
    .subsection-content::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #DAA520 0%, #B8860B 100%);
      border-radius: 10px;
      border: 2px solid #f1f1f1;
    }
    
    .subsection-content::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #B8860B 0%, #8B6914 100%);
    }
    
    /* Firefox scrollbar */
    .subsection-content {
      scrollbar-width: auto;
      scrollbar-color: #DAA520 #f1f1f1;
    }
    
    /* Desktop: Make sections scrollable so content below is visible */
    @media (min-width: 769px) {
      #activities-content.expanded {
        max-height: 600px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      #decisions-content.expanded {
        max-height: 600px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      #estimates-content.expanded {
        max-height: 600px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      #lodging-content.expanded {
        max-height: 600px;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }
    }
    
    /* Mobile-specific styles for better spacing */
    @media (max-width: 768px) {
      .subsection-content.expanded {
        margin-bottom: 40px;
        max-height: 70vh;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      #estimates-content.expanded {
        margin-bottom: 60px;
      }
      
      /* Allow My Trip Details to be taller since it's a form */
      #mytrip-content.expanded {
        max-height: 80vh;
      }
      
      /* Ensure text wraps properly on mobile */
      #mytrip-content input,
      #mytrip-content textarea,
      #mytrip-content select,
      #mytrip-content .info-box {
        word-wrap: break-word;
        overflow-wrap: break-word;
        max-width: 100%;
      }
      
      /* Make decisions section scrollable for easier viewing */
      #decisions-content.expanded {
        max-height: 70vh;
      }
      
      /* Make activities section scrollable - now has 13 activities */
      #activities-content.expanded {
        max-height: 70vh;
      }
    }
    
    /* Mobile font size adjustments for estimates section */
    @media (max-width: 480px) {
      /* Main heading - "Estimated Cost Breakdown (Per Person)" */
      #estimates-content h4 {
        font-size: 0.95rem !important;
      }
      
      #estimates-content p {
        font-size: 0.8rem !important;
      }
      
      #estimates-content .info-box {
        font-size: 0.8rem !important;
      }
      
      #estimates-content ul li {
        font-size: 0.8rem !important;
        line-height: 1.6 !important;
      }
      
      /* Make cost breakdown items stack better on small screens */
      #estimates-content > div > div > div[style*="display: flex"] {
        flex-direction: column !important;
        align-items: flex-start !important;
        gap: 8px !important;
      }
      
      /* Cost item labels */
      #estimates-content > div > div > div[style*="display: flex"] span:first-child {
        font-size: 0.85rem !important;
      }
      
      /* Cost amounts */
      #estimates-content > div > div > div[style*="display: flex"] span:last-child {
        font-size: 1.1rem !important;
      }
      
      /* Adjust total estimate box */
      #estimates-content > div > div[style*="background: #f8f9fa"] {
        padding: 12px !important;
      }
      
      #estimates-content > div > div[style*="background: #f8f9fa"] > div:first-child {
        font-size: 0.75rem !important;
      }
      
      #estimates-content > div > div[style*="background: #f8f9fa"] > div:nth-child(2) {
        font-size: 1.3rem !important;
      }
      
      #estimates-content > div > div[style*="background: #f8f9fa"] > div:last-child {
        font-size: 0.7rem !important;
      }
    }
    
    /* Mobile optimizations for flight form */
    @media (max-width: 480px) {
      #mytrip-content h4 {
        font-size: 1.1rem !important;
      }
      
      #mytrip-content h5 {
        font-size: 1rem !important;
      }
      
      #mytrip-content input,
      #mytrip-content select,
      #mytrip-content textarea {
        font-size: 0.9rem !important;
      }
      
      #mytrip-content label {
        font-size: 0.85rem !important;
      }
      
      #mytrip-content small {
        font-size: 0.75rem !important;
      }
      
      #mytrip-content .info-box {
        font-size: 0.85rem !important;
        padding: 10px !important;
      }
    }
    
    /* Print styles */
    @media print {
      .polka-dots,
      #quickLinks,
      .btn,
      button,
      .subsection-toggle {
        display: none !important;
      }
      
      .subsection-content {
        max-height: none !important;
        overflow: visible !important;
        opacity: 1 !important;
        transform: none !important;
      }
      
      .trip-card {
        page-break-inside: avoid;
        box-shadow: none !important;
      }
      
      body {
        background: white !important;
      }
      
      header {
        background: linear-gradient(135deg, #ff6b9d 0%, #c06c84 100%) !important;
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
      }
    }
  </style>
</head>
<body>
  <div class="polka-dots"></div>

  <header>
    <h1>ğŸ”´ SPRING 94 Dot Connection</h1>
    <p class="subtitle">Stay Connected, Share Memories, Plan Adventures</p>
    
    <!-- Countdown Timer -->
    <div class="countdown-container">
      <div class="countdown-title">â° Countdown to Montana Glamping Adventure</div>
      <div class="countdown-timer" id="countdown">
        <div class="countdown-item">
          <span class="countdown-number" id="days">250</span>
          <span class="countdown-label">Days</span>
        </div>
      </div>
    </div>
    <script>
    // Inline countdown to ensure it runs immediately
    (function() {
      function updateCountdown() {
        const reunionDate = new Date('September 9, 2026 00:00:00').getTime();
        const now = new Date().getTime();
        const distance = reunionDate - now;

        const daysElement = document.getElementById('days');
        
        if (!daysElement) return;

        if (distance < 0) {
          document.getElementById('countdown').innerHTML = '<div style="font-size: 1.5rem; font-weight: bold;">ğŸ‰ The Adventure Has Begun! ğŸ‰</div>';
          return;
        }

        const days = Math.floor(distance / (1000 * 60 * 60 * 24));

        daysElement.textContent = days;
      }
      
      // Run immediately
      updateCountdown();
      // Update every minute
      setInterval(updateCountdown, 60000);
    })();
    </script>
  </header>

  <!-- Sticky Quick Links Navigation -->
  <nav id="quickLinks" style="position: sticky; top: 0; z-index: 999; background: linear-gradient(135deg, #8B0000 0%, #5C0000 100%); box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 8px 0; transition: all 0.3s ease;">
    <div class="container" style="max-width: 1200px; margin: 0 auto; padding: 0 10px;">
      <div style="display: flex; gap: 6px; overflow-x: auto; white-space: nowrap; -webkit-overflow-scrolling: touch; scrollbar-width: thin; padding: 4px 0;">
        <a href="trip-dashboard.html" style="background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); color: #8B0000; padding: 6px 16px; border-radius: 15px; text-decoration: none; font-size: 0.85rem; font-weight: bold; transition: all 0.2s ease; flex-shrink: 0; box-shadow: 0 2px 8px rgba(255,215,0,0.3);">ğŸ“Š View Trip Dashboard</a>
        <a href="#contacts-content" onclick="scrollToSection('contacts', event); return false;" style="background: rgba(255,255,255,0.2); color: white; padding: 6px 12px; border-radius: 15px; text-decoration: none; font-size: 0.8rem; backdrop-filter: blur(10px); transition: all 0.2s ease; flex-shrink: 0;">ğŸ“‡ Contacts</a>
        <a href="#estimates-content" onclick="scrollToSection('estimates', event); return false;" style="background: rgba(255,255,255,0.2); color: white; padding: 6px 12px; border-radius: 15px; text-decoration: none; font-size: 0.8rem; backdrop-filter: blur(10px); transition: all 0.2s ease; flex-shrink: 0;">ğŸ’° Costs</a>
        <a href="#lodging-content" onclick="scrollToSection('lodging', event); return false;" style="background: rgba(255,255,255,0.2); color: white; padding: 6px 12px; border-radius: 15px; text-decoration: none; font-size: 0.8rem; backdrop-filter: blur(10px); transition: all 0.2s ease; flex-shrink: 0;">â›º Tents</a>
        <a href="#bookYourTent" onclick="scrollToElement('bookYourTent', event); return false;" style="background: rgba(255,255,255,0.2); color: white; padding: 6px 12px; border-radius: 15px; text-decoration: none; font-size: 0.8rem; backdrop-filter: blur(10px); transition: all 0.2s ease; flex-shrink: 0;">ğŸ“ Book</a>
        <a href="#bookYourTent" onclick="scrollToElement('bookYourTent', event); return false;" style="background: rgba(255,255,255,0.2); color: white; padding: 6px 12px; border-radius: 15px; text-decoration: none; font-size: 0.8rem; backdrop-filter: blur(10px); transition: all 0.2s ease; flex-shrink: 0;">ğŸ‘¥ Tentmates</a>
        <a href="#activities-content" onclick="scrollToSection('activities', event); return false;" style="background: rgba(255,255,255,0.2); color: white; padding: 6px 12px; border-radius: 15px; text-decoration: none; font-size: 0.8rem; backdrop-filter: blur(10px); transition: all 0.2s ease; flex-shrink: 0;">ğŸ¯ Activities</a>
        <button onclick="collapseAll()" style="background: rgba(255,255,255,0.3); color: white; padding: 6px 12px; border-radius: 15px; border: none; font-size: 0.8rem; backdrop-filter: blur(10px); transition: all 0.2s ease; flex-shrink: 0; cursor: pointer; font-weight: 500;">ğŸ“¦ Collapse</button>
      </div>
    </div>
  </nav>

  <div class="container">
    
    
    <!-- Add Contact Button -->
    <!-- Contacts Section -->
    <div class="section">
      <div class="section-header" onclick="toggleSection('contacts')">
        <h2 class="section-title">
          <span class="toggle-icon" id="contacts-icon">â–¶</span>
          ğŸ“‡ Contact Directory
        </h2>
      </div>
      <div class="section-content" id="contacts-content">
        <div class="info-box">
          <strong>ğŸ’¡ Tip:</strong> Click on any contact to edit their information. Don't forget to add your birthday! Changes are saved automatically.
        </div>
        <div class="text-center mt-20">
          <button class="btn btn-secondary btn-small" onclick="downloadContactsJSON()">
            ğŸ’¾ Download All Contacts
          </button>
        </div>
        <div class="contacts-grid" id="contacts-grid">
          <!-- Contacts will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Email List Section -->
    <div class="section">
      <div class="section-header" onclick="toggleSection('email')">
        <h2 class="section-title">
          <span class="toggle-icon" id="email-icon">â–¶</span>
          ğŸ“§ Email Everyone
        </h2>
      </div>
      <div class="section-content" id="email-content">
        <div class="info-box">
          <h3 style="margin-bottom: 15px;">How to Email the Group</h3>
          <ol style="margin-left: 20px;">
            <li>Click the button below to open your email client</li>
            <li>Your email will be in the "To" field</li>
            <li>All other contacts will be in "bcc"</li>
            <li>Edit the subject and message as needed</li>
          </ol>
        </div>
       <div class="text-center mt-20">
  <a class="btn btn-primary"
    href="mailto:YOURADDRESS@example.com?bcc=sum0316@gmail.com,dst894@hotmail.com,tamikalfrancis@gmail.com,errinmccomb@gmail.com,melaniebullock@yahoo.com,missdana213@gmail.com,vernet1@gmail.com,mdfikes@gmail.com,tephia25@yahoo.com,sherribelklaw@gmail.com,freshnclean9@gmail.com,kilpatrickn39@gmail.com,iamadelta@yahoo.com,michelleyfoxx@yahoo.com&subject=Spring%2094%20Dot%20Connection%20Updates&body=Hi%20everyone,%0A%0AHere%20are%20the%20latest%20updates%20for%20our%20Spring%2094%20Dot%20Connection%20group.%0A%0AThanks,%0A[Your%20Name]">
    ğŸ“§ Open Email Client
  </a>
</div>

        <div class="warning-box mt-20">
          <strong>ğŸ“‹ Copy & Paste Email List:</strong><br>
          <code style="display: block; margin-top: 10px; padding: 10px; background: white; border-radius: 8px; word-break: break-all;">
          sum0316@gmail.com; dst894@hotmail.com; tamikalfrancis@gmail.com; errinmccomb@gmail.com; melaniebullock@yahoo.com; missdana213@gmail.com; vernet1@gmail.com; mdfikes@gmail.com; tephia25@yahoo.com; sherribelklaw@gmail.com; freshnclean9@gmail.com; kilpatrickn39@gmail.com; iamadelta@yahoo.com; michelleyfoxx@yahoo.com
          </code>
        </div>
      </div>
    </div>

    <!-- Photo Albums Section -->
    <div class="section">
      <div class="section-header" onclick="toggleSection('photos')">
        <h2 class="section-title">
          <span class="toggle-icon" id="photos-icon">â–¶</span>
          ğŸ“¸ Photo Albums
        </h2>
      </div>
      <div class="section-content" id="photos-content">
        <div class="photo-links">
          <a href="https://link.shutterfly.com/AVu65l2xBJb" target="_blank" class="photo-link-card">
            <div class="photo-link-icon">ğŸ“</div>
            <div class="photo-link-title">Spring 94 Old Photos</div>
            <p>Throwback memories from our college days</p>
          </a>
          <a href="https://link.shutterfly.com/suiedxnxvNb" target="_blank" class="photo-link-card">
            <div class="photo-link-icon">ğŸˆ</div>
            <div class="photo-link-title">Homecoming 2024</div>
            <p>Recent reunion photos</p>
          </a>
          <a href="https://link.shutterfly.com/lurzZCVsxNb" target="_blank" class="photo-link-card">
            <div class="photo-link-icon">ğŸ“·</div>
            <div class="photo-link-title">Photoshoots</div>
            <p>Professional group photos</p>
          </a>
        </div>
        <div class="info-box mt-20">
          <strong>ğŸ” Shared Account Access:</strong><br>
          Email: <strong style="color: #2196f3;">dst894@yahoo.com</strong><br>
          Password: <strong style="color: #f44336;">BigSisterTr0ll!</strong>
        </div>
      </div>
    </div>

    <!-- Trip Details Section -->
    <div class="section">
      <div class="section-header" id="trip-section-header" onclick="toggleSection('trips')">
        <h2 class="section-title">
          <span class="toggle-icon" id="trips-icon">â–¶</span>
          â›º Dots Go Glamping - Yellowstone 2026 (Last Update 01/21/2026)
        </h2>
      </div>
      <div class="section-content" id="trips-content">
        
   <!-- Trip Overview -->
<div class="trip-card highlight">
  <div class="trip-title">â›º Dots Go Glamping</div>
  
  <div style="display: grid; gap: 12px; margin: 15px 0;">
    <p style="margin: 0;"><strong>ğŸ“ Location:</strong> Under Canvas Yellowstone - North Yellowstone (Paradise Valley), MT</p>
    <p style="margin: 0;"><strong>âœˆï¸ Airport:</strong> Bozeman Yellowstone International Airport BZN</p>
    <p style="margin: 0;"><strong>ğŸ“… Dates:</strong> <span style="color: var(--primary-color); font-weight: bold;">September 9-13, 2026</span></p>
  </div>
  
  <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 15px; background: #f8f9fa; margin: 15px 0;">
    <h4 style="color: var(--primary-dark); margin: 0 0 12px 0; font-size: 1.1rem;">ğŸ“… Accommodation Schedule</h4>
    <div style="display: grid; gap: 10px;">
      <div style="padding: 8px; background: white; border-radius: 5px;">
        <strong>ğŸ¨ Night 1:</strong> September 9-10<br>
        <a href="https://www.hilton.com/en/hotels/bznhtht-home2-suites-bozeman-midtown/" target="_blank" rel="noopener" style="color: var(--primary-color); text-decoration: none; font-size: 0.95rem;">
          Home2 Suites by Hilton Bozeman Midtown ğŸ”—
        </a>
      </div>
      <div style="padding: 8px; background: white; border-radius: 5px;">
        <strong>â›º Nights 2-3:</strong> September 10-12, 2026<br>
        <a href="https://www.undercanvas.com/camps/north-yellowstone/" target="_blank" rel="noopener" style="color: var(--primary-color); text-decoration: none; font-size: 0.95rem;">
          Under Canvas Yellowstone (Glamping) ğŸ”—
        </a>
      </div>
      <div style="padding: 8px; background: white; border-radius: 5px;">
        <strong>ğŸ¨ Night 4:</strong> September 12-13, 2026<br>
        <a href="https://www.hilton.com/en/hotels/bznbxhw-home2-suites-bozeman-four-corners/" target="_blank" rel="noopener" style="color: var(--primary-color); text-decoration: none; font-size: 0.95rem;">
          Home2 Suites By Hilton Bozeman Four Corners ğŸ”—
        </a>
      </div>
    </div>
  </div>
  
  <p style="margin-top: 15px; font-size: 1.1rem;">
    Experience luxury camping in one of America's most iconic national parks!
    Glamping combines the beauty of nature with the comfort of a hotel.
  </p>

  <!-- Meeting & Questions -->
  <div style="margin-top: 25px; padding: 20px; border: 2px solid var(--border-color); border-radius: 10px; background: white;">
    <div style="display: grid; gap: 20px;">

      <!-- Next Meeting Info -->
      <div>
        <h4 style="color: var(--primary-color); margin-bottom: 10px;">
          ğŸ“… Next Planning Meeting
        </h4>
        <p style="margin: 5px 0;">
          <strong>Tuesday, MArch 1, 2026 at 6:00 PM</strong>
        </p>
        <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 10px;">
          <a href="https://teams.microsoft.com/l/meetup-join/19%3ameeting_MGNmZmQzOWQtOTMwZi00OGI2LTk3NWQtYTM1MTg0N2E0NTk5%40thread.v2/0?context=%7b%22Tid%22%3a%22fcf67057-50c9-4ad4-98f3-ffca64add9e9%22%2c%22Oid%22%3a%22dad87919-9df2-42ae-ae08-b386dcdc75da%22%7d"
             target="_blank"
             style="display: inline-block; padding: 10px 20px; background: #5b5fc7; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
            ğŸ’» Join Teams Meeting
          </a>
          <a href="https://github.com/tamimoooo/agenda/blob/main/Agenda.pdf"
             target="_blank"
             style="display: inline-block; padding: 10px 20px; background: var(--primary-color); color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
            ğŸ“… View Meeting Agenda
          </a>
        </div>
      </div>

    </div>
  </div>

  <!-- Action Items -->
  <div style="margin-top: 25px; padding: 20px; border: 2px dashed var(--border-color); border-radius: 10px; background: #fafafa;">
    <h4 style="color: var(--primary-color); margin-bottom: 15px;">
      âœ… Action Items
    </h4>
    <ul style="margin: 0; padding-left: 20px; line-height: 1.6;">
      <li style="margin-top: 10px;">
        <strong>Discuss flight details</strong><br>
        Coordinate departure airport, arrival times, and booking plans.<br>
        <small style="color: #666; font-style: italic;">Note: <a href="trip-dashboard.html#travel-details" style="color: #d32f2f; text-decoration: underline;">Click to View Trip Dashboard</a> to check some arrival times</small>
      </li>
      <li style="margin-top: 10px;">
        <strong>Discuss driving options</strong><br>
        Coordinate carpooling, rental cars, or other ground transportation plans.
      </li>
	    <li style="margin-top: 10px;">
	       <strong>Committees, Questions</strong><br>
	       Have questions before the meeting? Click below to submit them.
	     </li>
	  
	  
	   </ul>
	   
	   <!-- Submit Questions Form (Collapsible) -->
	   <div style="margin-top: 20px; background: white; border-radius: 10px; border: 2px solid var(--primary-color); overflow: hidden;">
	     <div
	       onclick="toggleQuestionsForm()"
	       style="padding: 15px 20px; background: linear-gradient(135deg, #DAA520 0%, #B8860B 100%); color: white; cursor: pointer; display: flex; justify-content: space-between; align-items: center; transition: var(--transition);"
	       onmouseover="this.style.background='linear-gradient(135deg, #B8860B 0%, #8B6914 100%)'"
	       onmouseout="this.style.background='linear-gradient(135deg, #DAA520 0%, #B8860B 100%)'"
	     >
	       <h5 style="margin: 0; font-size: 1.1rem;">
	         â“ Submit Your Questions
	       </h5>
	       <span id="questionsToggle" style="font-size: 1.2rem; font-weight: bold; transition: transform 0.3s;">â–¶</span>
	     </div>
	     
	     <div id="questionsFormContent" style="display: none; padding: 20px;">
	       <form id="questionsForm" style="display: flex; flex-direction: column; gap: 15px;">
	       <div>
	         <label for="questionName" style="display: block; margin-bottom: 5px; font-weight: 600; color: var(--text-primary);">
	           Your Name <span style="color: red;">*</span>
	         </label>
	         <input
	           type="text"
	           id="questionName"
	           required
	           style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem;"
	           placeholder="Enter your name"
	         />
	       </div>
	       
	       <div>
	         <label for="questionEmail" style="display: block; margin-bottom: 5px; font-weight: 600; color: var(--text-primary);">
	           Your Email <span style="color: red;">*</span>
	         </label>
	         <input
	           type="email"
	           id="questionEmail"
	           required
	           style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem;"
	           placeholder="your.email@example.com"
	         />
	       </div>
	       
	       <div>
	         <label for="questionText" style="display: block; margin-bottom: 5px; font-weight: 600; color: var(--text-primary);">
	           Your Question(s) <span style="color: red;">*</span>
	         </label>
	         <textarea
	           id="questionText"
	           required
	           rows="5"
	           style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem; resize: vertical;"
	           placeholder="Enter your questions or concerns here..."
	         ></textarea>
	       </div>
	       
	       <button
	         type="submit"
	         style="padding: 12px 24px; background: #DAA520; color: white; border: none; border-radius: 5px; font-size: 1rem; font-weight: bold; cursor: pointer; transition: var(--transition);"
	         onmouseover="this.style.background='#B8860B'"
	         onmouseout="this.style.background='#DAA520'"
	       >
	         ğŸ“¤ Submit Question
	       </button>
	       </form>
	       <div id="questionStatus" style="margin-top: 15px; padding: 10px; border-radius: 5px; display: none;"></div>
	     </div>
	   </div>
	 </div>

</div>


        <!-- Travel Estimates Section -->
        <div class="trip-card">
          <div class="subsection-header" onclick="toggleSubsection('estimates')">
            <h3 class="subsection-title">ğŸ’° Travel Estimates <span style="background: #ff4444; color: white; padding: 3px 8px; border-radius: 4px; font-size: 0.7rem; margin-left: 10px; font-weight: bold;">NEW INFO</span></h3>
            <span class="subsection-toggle" id="estimates-toggle">â–¶</span>
          </div>
          <div class="subsection-content" id="estimates-content">
            
            <!-- Summary Box -->
            <div style="border: 3px solid var(--primary-color); border-radius: 15px; padding: 20px; margin-bottom: 25px; background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%);">
              <h4 style="color: var(--primary-color); margin-bottom: 15px; font-size: 1.3rem;">ğŸ’° Estimated Cost Breakdown (Per Person)</h4>
              <p style="font-size: 0.95rem; color: var(--text-secondary); margin-bottom: 20px; font-style: italic;">
                September 9-13, 2026 â€¢ All prices are estimates and subject to change
              </p>
              
              <div style="display: grid; gap: 12px; font-size: 1rem;">
                <!-- Hotels -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                  <span><strong>ğŸ¨ Hotels</strong> (2 nights: Sept 9-10 & Sept 12-13)<br><span style="font-size: 0.85rem; color: var(--text-secondary); font-style: italic;">*Optional 3rd night not included</span></span>
                  <span style="color: var(--primary-color); font-weight: bold; font-size: 1.1rem;">$358</span>
                </div>
                
                <!-- Glamping -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                  <span><strong>â›º Glamping Tent</strong> (2 nights: Sept 10-12)</span>
                  <span style="color: var(--primary-color); font-weight: bold; font-size: 1.1rem;">$400-$620</span>
                </div>
                
                <!-- Transportation -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; border-left: 4px solid #6c757d;">
                  <span><strong>ğŸš Van Rental</strong> (airport pickup & trip transport)</span>
                  <span style="color: #6c757d; font-weight: bold; font-size: 1.1rem;">TBD</span>
                </div>
                
                <!-- Activities -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                  <span><strong>ğŸ¯ Activities</strong> (average for 2 activities)</span>
                  <span style="color: var(--primary-color); font-weight: bold; font-size: 1.1rem;">~$105</span>
                </div>
                
                <!-- Airfare -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 8px; border-left: 4px solid #6c757d;">
                  <span><strong>âœˆï¸ Airfare</strong> (to/from Bozeman, MT)</span>
                  <span style="color: #6c757d; font-weight: bold; font-size: 1.1rem;">Varies</span>
                </div>
              </div>
              
              <!-- Total Estimate -->
              <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border: 2px solid var(--border-color); border-radius: 10px;">
                <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 5px;">Estimated Total (excluding airfare & van)</div>
                <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary-dark);">$863 - $1,083</div>
                <div style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 5px;">+ airfare + van rental (TBD)</div>
              </div>
            </div>

            <!-- Additional Details -->
            <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 20px; background: white; margin-bottom: 20px;">
              <h4 style="color: var(--primary-dark); margin-bottom: 15px;">ğŸ“‹ What's Included</h4>
              <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                <li><strong>Hotels:</strong> 2 nights at Home2 Suites (Sept 9-10 & Sept 12-13)</li>
                <li><strong>Glamping:</strong> 2 nights in luxury tent (Sept 10-12) - price varies by tent type</li>
                <li><strong>Activities:</strong> Optional group activities (rafting, horseback riding, etc.)</li>
                <li><strong>Transportation:</strong> Shared van rental cost (to be determined at group meeting)</li>
              </ul>
            </div>

            <!-- Important Notes -->
            <div class="info-box">
              <strong>âš ï¸ Important Notes:</strong>
              <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                <li>All prices are <strong>estimates</strong> and subject to change based on final bookings</li>
                <li>Tent prices vary by type ($400-$620 range) - see Lodging section for options</li>
                <li>Van rental cost will be determined once everyone confirms attendance</li>
                <li>Activities are <strong>optional</strong> - choose what interests you</li>
                <li>Book airfare early for best rates to Bozeman, MT (BZN)</li>
                <li><strong>Attendance confirmation deadline:</strong> September 6, 2026 (hotel cancellation deadline)</li>
              </ul>
            </div>

          </div>
        </div>

        <!-- Trip Action Items Section -->
        <div class="trip-card">
          <div class="subsection-header" onclick="toggleSubsection('decisions')">
            <h3 class="subsection-title">âœ… Your Trip Action Items</h3>
            <span class="subsection-toggle" id="decisions-toggle">â–¶</span>
          </div>
          <div class="subsection-content" id="decisions-content">
            
            <div class="info-box" style="margin-bottom: 20px;">
              <strong>ğŸ“‹ Important:</strong> Please make these decisions and submit your information as soon as possible to help with planning and reservations.
            </div>

            <!-- Decision Items -->
            <div style="display: grid; gap: 20px;">
              
              <!-- 1. Activities -->
              <div style="border: 2px solid var(--primary-color); border-radius: 10px; padding: 20px; background: white;">
                <h4 style="color: var(--primary-color); margin-bottom: 15px;">
                  ğŸ¯ 3. View and Submit Activities
                </h4>
                <p style="margin-bottom: 10px;">Browse available activities and submit your selections for the trip.</p>
                <div style="padding: 10px; background: #f8f9fa; border-radius: 5px; margin-bottom: 10px;">
                  <strong>Options:</strong> White Water Rafting ($164), Bike & Hike to Osprey Falls ($250 or $95 rental)
                </div>
                <a href="#activities-content" onclick="openSectionAndScroll('activities', 'activities-content', event)" class="btn btn-secondary" style="display: inline-block; margin-top: 10px; text-decoration: none;">
                  View & Submit Activities
                </a>
              </div>

              <!-- 4. Travel Plans -->
              <div style="border: 2px solid var(--primary-color); border-radius: 10px; padding: 20px; background: white;">
                <h4 style="color: var(--primary-color); margin-bottom: 15px;">
                  âœˆï¸ 4. Submit Flight Details!
                </h4>
                <p style="margin-bottom: 10px;">Arrange your travel to/from Bozeman, Montana for September 9-13, 2026.</p>
                <div style="padding: 10px; background: #fff3cd; border-radius: 5px; margin-bottom: 10px;">
                  <strong>âš ï¸ Reminder:</strong> Coordinate arrival times for airport transportation (car/shuttle/van) to the resort<br>
                  <small style="color: #666; font-style: italic;">Note: <a href="trip-dashboard.html#travel-details" style="color: #d32f2f; text-decoration: underline;">Click to View Trip Dashboard</a> to check some arrival times</small>
                </div>
                <a href="#mytrip-content" onclick="openSectionAndScroll('mytrip', 'mytrip-content', event)" class="btn btn-secondary" style="display: inline-block; margin-top: 10px; text-decoration: none;">
                  Submit Flight Details!
                </a>
              </div>

              <!-- 5. Deadline -->
              <div style="border: 2px solid #ffc107; border-radius: 10px; padding: 20px; background: #fff3cd;">
                <h4 style="color: #856404; margin-bottom: 15px;">
                  ğŸ’° 5. Deadline
                </h4>
                <p style="margin-bottom: 10px; color: #856404;">
                  <strong>Hotel payment cancellation deadline:</strong> September 6, 2026
                </p>
                <p style="color: #856404; font-size: 0.9rem;">
                  Payment details and instructions will be provided once all reservations are confirmed.
                </p>
              </div>

            </div>

            <!-- Action Summary -->
            <div style="margin-top: 25px; padding: 20px; background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%); border: 3px solid var(--primary-color); border-radius: 10px;">
              <h4 style="color: var(--primary-color); margin-bottom: 15px;">ğŸ“ Quick Action Checklist</h4>
              <ul style="margin-left: 20px; line-height: 1.8;">
                <li>âœ… Review tent options and pricing</li>
                <li>âœ… Confirm your tentmates</li>
                <li>âœ… Select activities you want to join</li>
                <li>âœ… Book your flights to Bozeman</li>
                <li>âœ… Submit all your information using the forms on this page</li>
                <li>âœ… Mark your calendar for payment deadline</li>
              </ul>
            </div>

          </div>
        </div>

        <!-- Tent  Options & Pricing - TEMPORARILY COMMENTED OUT -->
        
        <div class="trip-card">
          <div class="subsection-header" onclick="toggleSubsection('lodging')">
            <h3 class="subsection-title">ğŸ•ï¸ Tent Options & Map <span style="background: #ff4444; color: white; padding: 3px 8px; border-radius: 4px; font-size: 0.7rem; margin-left: 10px; font-weight: bold;">NEW INFO</span></h3>
            <span class="subsection-toggle" id="lodging-toggle">â–¶</span>
          </div>
          <div class="subsection-content" id="lodging-content">

          <p style="margin-bottom: 20px;"><em>Tent Stay: September 10-12, 2026 (2 nights)</em></p>

          <!-- Campsite Map -->
          <details style="margin-bottom: 30px;">
            <summary style="cursor: pointer; padding: 12px 15px; background: #f0f0f0; color: var(--primary-color); border: 2px solid var(--border-color); border-radius: 8px; font-weight: normal; font-size: 1rem; text-align: center;">
              ğŸ“ Under Canvas Yellowstone Campsite Map - Click to View
            </summary>
            <div style="margin-top: 15px; border: 3px solid var(--primary-color); border-radius: 10px; padding: 20px; background: white;">
              <img src="map_.png"
                   alt="Under Canvas Yellowstone Campsite Layout Map"
                   style="width: 100%; height: auto; border-radius: 8px; margin-bottom: 15px;">
              
              <!-- Collapsible Zoomed Map -->
              <details style="margin-top: 10px;">
                <summary style="cursor: pointer; padding: 10px; background: #f0f0f0; border-radius: 5px; color: var(--primary-color); font-weight: 500; font-size: 0.9rem;">
                  â›º Map with Tent Grouping - Click Here
                </summary>
                <div style="margin-top: 10px; padding: 10px; border: 2px solid #e0e0e0; border-radius: 5px;">
                  <img src="map_zoom.png"
                       alt="Under Canvas Yellowstone Campsite Layout Map - Zoomed View"
                       style="width: 100%; height: auto; border-radius: 5px;">
                </div>
              </details>
              
              <!-- Collapsible Color Highlighted Map -->
              <details style="margin-top: 10px;">
                <summary style="cursor: pointer; padding: 10px; background: #f0f0f0; border-radius: 5px; color: var(--primary-color); font-weight: 500; font-size: 0.9rem;">
                  ğŸ¨ Map with Color Highlighted - Click Here
                </summary>
                <div style="margin-top: 10px; padding: 10px; border: 2px solid #e0e0e0; border-radius: 5px;">
                  <img src="map2.png"
                       alt="Under Canvas Yellowstone Campsite Layout Map - Color Highlighted"
                       style="width: 100%; height: auto; border-radius: 5px;">
                </div>
              </details>
              
              <!-- Map Link -->
              <div style="margin-top: 15px; text-align: center;">
                <a href="https://www.undercanvas.com/camps/north-yellowstone/#tab-6-2"
                   target="_blank"
                   style="display: inline-block; padding: 10px 20px; background: var(--primary-color); color: white; text-decoration: none; border-radius: 5px; font-weight: 500; font-size: 0.9rem;">
                  ğŸ—ºï¸ View Interactive Map on Under Canvas Website
                </a>
              </div>
            </div>
          </details>

          <!-- Book Your Tent -->
          <details id="bookYourTent" style="margin-bottom: 20px;">
            <summary style="cursor: pointer; padding: 12px 15px; background: #f0f0f0; color: var(--primary-color); border: 2px solid var(--border-color); border-radius: 8px; font-weight: normal; font-size: 1rem; text-align: center;">
              ğŸ“ Book Your Tent - Click to View Contact Info
            </summary>
            <div style="margin-top: 15px; padding: 20px; background: #f0f8ff; border: 2px solid var(--primary-color); border-radius: 8px;">
              <h5 style="color: var(--primary-dark); margin-bottom: 15px; text-align: center;">Contact Tavia to Book</h5>
              <div style="text-align: center; font-size: 0.95rem;">
                <p style="margin: 5px 0;">
                  <strong>Phone:</strong> <a href="tel:+18884961148,049" style="color: var(--primary-color); text-decoration: none;">1-888-496-1148 ext. 049</a>
                </p>
                <p style="margin: 5px 0;">
                  <strong>Email:</strong> <a href="mailto:tavia.neal@undercanvas.com" style="color: var(--primary-color); text-decoration: none;">tavia.neal@undercanvas.com</a>
                </p>
                <p style="margin: 10px 0 0 0; font-style: italic; color: var(--text-secondary); font-size: 0.9rem;">
                  Ask for Tavia when booking for our group
                </p>
                <p style="margin: 15px 0 0 0;">
                  <a href="https://www.undercanvas.com/camps/north-yellowstone/" target="_blank" style="display: inline-block; padding: 10px 20px; background: var(--primary-color); color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
                    ğŸ•ï¸ Book on Under Canvas Website
                  </a>
                </p>
              </div>
            </div>
          </details>

          <!-- Tent Options Collapsible -->
          <details id="tentOptionsDetails" style="margin-bottom: 20px;">
            <summary style="cursor: pointer; padding: 12px 15px; background: #f0f0f0; color: var(--primary-color); border: 2px solid var(--border-color); border-radius: 8px; font-weight: normal; font-size: 1rem; text-align: center;">
              â›º View Tent Options
            </summary>
            <div style="margin-top: 15px; display: grid; gap: 15px;">
              <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 15px; background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);">
                <h4 style="color: var(--primary-color); margin-bottom: 10px;">â›º Delux Tent</h4>
                <ul style="margin-left: 20px; font-size: 0.95rem;">
                  <li>One King Bed</li>
                  <li>One Bath - toilet, sep shower, sep sink</li>
                  <li>All within the tent</li>
                </ul>
              </div>

              <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 15px; background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);">
                <h4 style="color: var(--primary-color); margin-bottom: 10px;">â­ Stargazer Tent</h4>
                <ul style="margin-left: 20px; font-size: 0.95rem;">
                  <li>One King Bed & a night sky viewing window</li>
                  <li>Private ensuite bathroom</li>
                </ul>
              </div>

              <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 15px; background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);">
                <h4 style="color: var(--primary-color); margin-bottom: 10px;">ğŸŒŸ Suite Tent</h4>
                <ul style="margin-left: 20px; font-size: 0.95rem;">
                  <li>Same as Stargazer but also has a queen sofa bed</li>
                </ul>
              </div>

              <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 15px; background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);">
                <h4 style="color: var(--primary-color); margin-bottom: 10px;">ğŸï¸ Yellowstone River Suite</h4>
                <ul style="margin-left: 20px; font-size: 0.95rem;">
                  <li>2 Suite Tents, 2 Delux Tents w/ 2 Twin Beds</li>
                  <li>Connected by an expansive private deck</li>
                  <li>Yellowstone River Cabin</li>
                  <li>Alder Stargazer</li>
                </ul>
              </div>

              <div class="info-box" style="margin-top: 20px;">
                <strong>ğŸ“ Note:</strong> For current pricing, please visit the resort's website. Prices are subject to change.
              </div>
            </div>
          </details>
          </div>
        </div>

        <!-- Cost & Payment - HIDDEN FOR NOW -->
        <!-- Uncomment when ready to show payment details
        <div class="trip-card">
          <div class="subsection-header" onclick="toggleSubsection('payment')">
            <h3 class="subsection-title">ğŸ’° Payment Details</h3>
            <span class="subsection-toggle" id="payment-toggle">â–¶</span>
          </div>
          <div class="subsection-content" id="payment-content">
          
          <h4 style="color: var(--primary-dark);">Payment Schedule (TBD):</h4>
          <ul style="margin-left: 20px; margin-top: 10px;">
            <li><strong>Deposit:</strong> Amount & due date TBD</li>
            <li><strong>Second Payment:</strong> Amount & due date TBD</li>
            <li><strong>Final Payment:</strong> Amount & due date TBD</li>
          </ul>

          <h4 style="margin-top: 20px; color: var(--primary-dark);">Payment Methods:</h4>
          <ul style="margin-left: 20px; margin-top: 10px;">
            <li><strong>Zelle:</strong> Details TBD</li>
            <li><strong>Cash App:</strong> Details TBD</li>
            <li><strong>Venmo:</strong> Details TBD</li>
          </ul>
          </div>
        </div>
        -->

        <!-- Activities & Excursions -->
        <div class="trip-card">
          <div class="subsection-header" onclick="toggleSubsection('activities')">
            <h3 class="subsection-title">ğŸ¯ Activities & Excursions <span style="background: #ff4444; color: white; padding: 3px 8px; border-radius: 4px; font-size: 0.7rem; margin-left: 10px; font-weight: bold;">NEW INFO</span></h3>
            <span class="subsection-toggle" id="activities-toggle">â–¶</span>
          </div>
          <div class="subsection-content" id="activities-content">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
            <p style="margin: 0;">Choose your adventure! Here are some exciting activities available:</p>
            <button onclick="downloadActivitiesList()" style="background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; font-size: 0.9rem; box-shadow: 0 2px 4px rgba(0,0,0,0.2); transition: all 0.3s ease;">
              ğŸ“¥ Download List
            </button>
          </div>

          <div id="activitiesListContainer" style="display: grid; gap: 15px;">
            <!-- Activities will be loaded dynamically from activity_suggestions.json -->
            <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
              <p>Loading activities...</p>
            </div>
          </div>

            <div class="warning-box" style="margin-top: 20px;">
              <strong>ğŸ“ Note:</strong> Activities are optional and not included in base lodging cost. Book activities that interest you! More details and booking information coming soon.

            <!-- Activity Suggestions Section -->
            <div style="margin-top: 30px; border: 2px solid var(--border-color); border-radius: 10px; background: white;">
              <details style="cursor: pointer;">
                <summary style="padding: 15px; font-weight: bold; color: var(--primary-color); font-size: 1.1rem; list-style: none;">
                  <span style="display: inline-block;">ğŸ’¡ Suggest an Activity (Click to expand/close)</span>
                </summary>
                <div style="padding: 20px 20px 60px 20px; border-top: 1px solid var(--border-color);">
                  <p style="margin-bottom: 20px; color: var(--text-secondary);">
                    Have an activity idea? Share it with the group! Your suggestions will be displayed below for everyone to see.
                  </p>

              <!-- Activity Suggestion Form -->
              <form id="activitySuggestionForm" style="display: grid; gap: 15px;">
                
                <!-- Location Selection -->
                <div>
                  <label style="display: block; margin-bottom: 5px; font-weight: bold; color: var(--primary-dark);">
                    ğŸ“ Activity Location: <span style="color: red;">*</span>
                  </label>
                  <select id="activityLocation" required 
                          style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem;">
                    <option value="">Select location</option>
                    <option value="bozeman">ğŸ“ Bozeman Area</option>
                    <option value="yellowstone">ğŸï¸ Yellowstone Park Area</option>
                  </select>
                </div>

                <!-- Activity Name -->
                <div>
                  <label style="display: block; margin-bottom: 5px; font-weight: bold; color: var(--primary-dark);">
                    Activity Name: <span style="color: red;">*</span>
                  </label>
                  <input type="text" id="activityName" required 
                         style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem;"
                         placeholder="e.g., Hot Springs Visit, Museum Tour, etc.">
                </div>

                <!-- Activity Description -->
                <div>
                  <label style="display: block; margin-bottom: 5px; font-weight: bold; color: var(--primary-dark);">
                    Description: <span style="color: red;">*</span>
                  </label>
                  <textarea id="activityDescription" required rows="3"
                            style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem; font-family: inherit;"
                            placeholder="Describe the activity and why you think the group would enjoy it..."></textarea>
                </div>

                <!-- Estimated Cost (Optional) -->
                <div>
                  <label style="display: block; margin-bottom: 5px; font-weight: bold; color: var(--primary-dark);">
                    Estimated Cost (Optional)
                  </label>
                  <input type="text" id="activityCost" 
                         style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem;"
                         placeholder="e.g., $50 per person, Free, etc.">
                </div>

                <!-- Website/Link (Optional) -->
                <div>
                  <label style="display: block; margin-bottom: 5px; font-weight: bold; color: var(--primary-dark);">
                    Website or Link (Optional)
                  </label>
                  <input type="url" id="activityLink" 
                         style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem;"
                         placeholder="https://...">
                </div>

                <!-- Your Name -->
                <div>
                  <label style="display: block; margin-bottom: 5px; font-weight: bold; color: var(--primary-dark);">
                    Your Name: <span style="color: red;">*</span>
                  </label>
                  <input type="text" id="suggesterName" required 
                         style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem;"
                         placeholder="Your name">
                </div>

                <!-- Submit Button -->
                <div style="text-align: center;">
                  <button type="submit" class="btn btn-primary" style="max-width: 400px; width: 100%; padding: 15px; font-size: 1.1rem; margin-bottom: 10px;">
                    âœ¨ Submit Activity Suggestion
                  </button>
                </div>

                <p style="font-size: 0.9rem; color: var(--text-secondary); text-align: center; margin: 0 0 20px 0;">
                  Your suggestion will be displayed below and emailed to the link admin
                </p>
              </form>
                </div>
              </details>
            </div>
          </div>
          </div>
        </div>


        <!-- My Trip Details & Itinerary Generator -->
        <div class="trip-card">
          <div class="subsection-header" onclick="toggleSubsection('mytrip')">
            <h3 class="subsection-title">âœˆï¸ My Trip Details <span style="font-size: 0.75rem; color: #666; font-weight: normal;">(Submit your travel and activities)</span></h3>
            <span class="subsection-toggle" id="mytrip-toggle">â–¶</span>
          </div>
          <div class="subsection-content" id="mytrip-content">
            <p style="margin-bottom: 20px; color: var(--text-secondary);">
              Fill out your personal trip information below and submit to admin. Once everything is finalized before departure, you'll be able to download a personalized Word document with all your trip details, hotel addresses, and important information in one place!  Once submitted you will see your updates in <strong><u>View Trip Dashboard in 24 hours</u></strong>.
            </p>

            <!-- View Trip Dashboard Button -->
            <div style="text-align: center; margin-bottom: 25px;">
              <a href="trip-dashboard.html"
                 style="display: inline-block; padding: 15px 30px; background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); color: #8B0000; text-decoration: none; border-radius: 25px; font-weight: bold; font-size: 1.1rem; transition: all 0.3s ease; box-shadow: 0 4px 6px rgba(218,165,32,0.3);"
                 onmouseover="this.style.background='linear-gradient(135deg, #FFA500 0%, #FFD700 100%)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 12px rgba(218,165,32,0.5)'"
                 onmouseout="this.style.background='linear-gradient(135deg, #FFD700 0%, #FFA500 100%)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px rgba(218,165,32,0.3)'">
                ğŸ“Š View Trip Dashboard
              </a>
            </div>

            <!-- Form -->
            <form id="tripDetailsForm" style="display: grid; gap: 20px;">
              
              <!-- User Identification Section -->
              <div style="border: 2px solid var(--primary-color); border-radius: 10px; padding: 20px; background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%);">
                <h4 style="color: var(--primary-dark); margin-bottom: 15px;">ğŸ‘¤ Your Information</h4>
                <div style="display: grid; gap: 10px;">
                  <label style="font-weight: bold; color: var(--primary-dark);">
                    Select Your Name: <span style="color: red;">*</span>
                  </label>
                  <select id="tripUserName" required
                          style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem;">
                    <option value="">-- Select your name --</option>
                  </select>
                  <input type="hidden" id="tripUserId">
                </div>
              </div>

              <!-- Flight Information Section -->
              <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 20px; background: #f9f9f9;">
                <h4 style="color: var(--primary-dark); margin-bottom: 15px;">âœˆï¸ Flight Information</h4>
                
                <div class="info-box" style="margin-bottom: 15px; background: #e7f3ff; border-left: 4px solid #2196F3;">
                  <strong>â„¹ï¸ Note:</strong> We only need your arrival time in Bozeman and departure time from Bozeman for van coordination. If you have connecting flights, just enter the final arrival/departure times.
                </div>
                
                <div style="display: grid; gap: 15px;">
                  <!-- Arrival in Bozeman -->
                  <div>
                    <h5 style="color: var(--secondary-color); margin-bottom: 10px;">ğŸ“ Arrival in Bozeman</h5>
                    <div style="display: grid; gap: 10px;">
                      <input type="text" id="outboundDepartureCity"
                             style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px;"
                             placeholder="Your Departure City (e.g., Atlanta, GA)">
                      <input type="text" id="outboundAirline"
                             style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px;"
                             placeholder="Airline (e.g., Delta, United)">
                      <input type="text" id="outboundFlightNumber"
                             style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px;"
                             placeholder="Final Flight Number to Bozeman (e.g., DL406)">
                      <div>
                        <label for="outboundArrival" style="display: block; margin-bottom: 5px; font-size: 0.9rem; color: var(--text-primary); font-weight: 500;">
                          <strong>Arrival Time in Bozeman</strong> <span style="color: red;">*</span>
                        </label>
                        <input type="datetime-local" id="outboundArrival" required
                               style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px;">
                        <small style="color: var(--text-secondary); font-size: 0.85rem;">When your flight lands in Bozeman (for coordination)</small>
                      </div>
                      <input type="text" id="outboundConfirmation"
                             style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px;"
                             placeholder="Confirmation Number (optional)">
                      <!-- Hidden fields to maintain compatibility -->
                      <input type="hidden" id="outboundArrivalCity" value="Bozeman, MT">
                      <input type="hidden" id="outboundDeparture" value="">
                    </div>
                  </div>

                  <!-- Departure from Bozeman -->
                  <div>
                    <h5 style="color: var(--secondary-color); margin-bottom: 10px;">ğŸ›« Departure from Bozeman</h5>
                    <div style="display: grid; gap: 10px;">
                      <input type="text" id="returnArrivalCity"
                             style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px;"
                             placeholder="Your Final Destination (e.g., Atlanta, GA)">
                      <input type="text" id="returnAirline"
                             style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px;"
                             placeholder="Airline (e.g., Delta, United)">
                      <input type="text" id="returnFlightNumber"
                             style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px;"
                             placeholder="First Flight Number from Bozeman (e.g., DL406)">
                      <div>
                        <label for="returnDeparture" style="display: block; margin-bottom: 5px; font-size: 0.9rem; color: var(--text-primary); font-weight: 500;">
                          <strong>Departure Time from Bozeman</strong> <span style="color: red;">*</span>
                        </label>
                        <input type="datetime-local" id="returnDeparture" required
                               style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px;">
                        <small style="color: var(--text-secondary); font-size: 0.85rem;">When your flight leaves Bozeman (for coordination)</small>
                      </div>
                      <input type="text" id="returnConfirmation"
                             style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px;"
                             placeholder="Confirmation Number (optional)">
                      <!-- Hidden fields to maintain compatibility -->
                      <input type="hidden" id="returnDepartureCity" value="Bozeman, MT">
                      <input type="hidden" id="returnArrival" value="">
                    </div>
                  </div>
                </div>
              </div>

              <!-- Tent Selection -->
              <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 20px; background: #f9f9f9;">
                <h4 style="color: var(--primary-dark); margin-bottom: 15px;">ğŸ•ï¸ Tent Selection</h4>
                <select id="selectedTent"
                        style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 1rem; margin-bottom: 10px;">
                  <option value="">Select your tent type</option>
                  <option value="Stargazer">Stargazer Tent</option>
                  <option value="Deluxe">Deluxe Tent</option>
                  <option value="Suite">Suite Tent</option>
                  <option value="Yellowstone River">Yellowstone River Tent</option>
                  <option value="Tipi">Tipi Tent</option>
                  <option value="Safari">Safari Tent</option>
                  <option value="Family">Family Tent</option>
                </select>
                <input type="text" id="tentConfirmation"
                       style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; margin-bottom: 10px;"
                       placeholder="Tent Confirmation Number (if you have one)">
                <textarea id="tentNotes" rows="2"
                       style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-family: inherit;"
                       placeholder="Tent preferences or notes (e.g., near bathroom, quiet area, accessibility needs)"></textarea>
              </div>

              <!-- Transportation Needs Section -->
              <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 20px; background: #f9f9f9;">
                <h4 style="color: var(--primary-dark); margin-bottom: 15px;">ğŸš Transportation</h4>
                <div style="display: grid; gap: 15px;">
                  <div>
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                      <input type="checkbox" id="needsAirportPickup" style="width: 20px; height: 20px;">
                      <span style="font-weight: bold;">I need airport pickup</span>
                    </label>
                  </div>
                  <div>
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                      <input type="checkbox" id="needsAirportDropoff" style="width: 20px; height: 20px;">
                      <span style="font-weight: bold;">I need airport dropoff</span>
                    </label>
                  </div>
                  <div>
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                      <input type="checkbox" id="willingToRentCar" style="width: 20px; height: 20px;">
                      <span style="font-weight: bold;">I'm willing to drive rental car/van</span>
                    </label>
                  </div>
                </div>
              </div>

              <!-- Activities Selection Section -->
              <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 20px; background: #f9f9f9;">
                <h4 style="color: var(--primary-dark); margin-bottom: 15px;">ğŸ¯ Activities I'm Interested In</h4>
                <p style="margin-bottom: 15px; color: var(--text-secondary); font-size: 0.9rem;">
                  Select activities you'd like to participate in during the trip. You can select multiple activities.
                </p>
                <div style="display: grid; gap: 10px;">
                  <label style="font-weight: bold; color: var(--primary-dark);">
                    Select Activities:
                  </label>
                  <select id="tripActivitiesDropdown" multiple size="8"
                          style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-size: 0.95rem;">
                    <option value="">Loading activities...</option>
                  </select>
                  <p style="font-size: 0.85rem; color: var(--text-secondary); font-style: italic;">
                    ğŸ’¡ Tip: Hold Ctrl (Windows) or Cmd (Mac) to select multiple activities
                  </p>
                </div>
              </div>

              <!-- Special Requests Section -->
              <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 20px; background: #f9f9f9;">
                <h4 style="color: var(--primary-dark); margin-bottom: 15px;">ğŸ’¬ Special Requests</h4>
                <textarea id="specialRequests" rows="4"
                          style="width: 100%; padding: 10px; border: 2px solid var(--border-color); border-radius: 5px; font-family: inherit; font-size: 1rem;"
                          placeholder="Any dietary restrictions, accessibility needs, or other special requests..."></textarea>
              </div>

            <!-- Action Buttons -->
            <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
              <button type="button" onclick="submitFlightDetails()" class="btn btn-primary" style="padding: 15px 30px; font-size: 1.1rem; min-width: 200px;">
                ğŸ“§ Submit to Admin
              </button>
              <button type="button" onclick="downloadTripItinerary()" class="btn btn-secondary" style="padding: 15px 30px; font-size: 1.1rem; min-width: 200px;">
                ğŸ“¥ Download Itinerary
              </button>
            </div>

            <div class="info-box" style="margin-top: 10px;">
              <strong>ğŸ“ Note:</strong> Click "Submit to Admin" to email your flight details to the organizer. The itinerary download includes all your trip information. Once submitted you will see your updates in <strong><u>View Trip Dashboard in 24 hours</u></strong>.
            </div>

            <!-- View Trip Dashboard Button -->
            <div style="text-align: center; margin-top: 20px;">
              <a href="trip-dashboard.html"
                 style="display: inline-block; padding: 15px 30px; background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%); color: #8B0000; text-decoration: none; border-radius: 25px; font-weight: bold; font-size: 1.1rem; transition: all 0.3s ease; box-shadow: 0 4px 6px rgba(218,165,32,0.3);"
                 onmouseover="this.style.background='linear-gradient(135deg, #FFA500 0%, #FFD700 100%)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 12px rgba(218,165,32,0.5)'"
                 onmouseout="this.style.background='linear-gradient(135deg, #FFD700 0%, #FFA500 100%)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px rgba(218,165,32,0.3)'">
                ğŸ“Š View Trip Dashboard
              </a>
            </div>
          </form>
          
          <!-- Back to Top Button -->
          <div style="text-align: center; margin-top: 30px; padding: 20px 20px 60px 20px;">
            <a href="#trip-section-header" onclick="scrollToTop(event)" style="display: inline-block; padding: 15px 30px; background: linear-gradient(135deg, #d32f2f 0%, #f06d6d 100%); color: white; text-decoration: none; border-radius: 25px; font-weight: bold; font-size: 1.1rem; transition: all 0.3s ease; box-shadow: 0 4px 6px rgba(211,47,47,0.3);" onmouseover="this.style.background='linear-gradient(135deg, #b22222 0%, #d32f2f 100%)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 12px rgba(211,47,47,0.5)'" onmouseout="this.style.background='linear-gradient(135deg, #d32f2f 0%, #f06d6d 100%)'; this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px rgba(211,47,47,0.3)'">
              â¬†ï¸ Back to Trip Overview
            </a>
          </div>
        </div>

        <!-- Itinerary - HIDDEN FOR NOW -->
        <!-- Uncomment when ready to show itinerary
        <div class="trip-card">
          <div class="subsection-header" onclick="toggleSubsection('itinerary')">
            <h3 class="subsection-title">ğŸ“‹ Itinerary</h3>
            <span class="subsection-toggle" id="itinerary-toggle">â–¶</span>
          </div>
          <div class="subsection-content" id="itinerary-content">
            <div class="info-box">
              <strong>ğŸ—“ï¸ Detailed schedule coming soon!</strong><br>
              <em>We're working on an amazing itinerary filled with adventure, relaxation, and sisterhood. Check back for updates!</em>
            </div>
          </div>
        </div>
        -->

        <!-- Packing Suggestions - HIDDEN FOR NOW -->
        <!-- Uncomment when ready to show packing list
        <div class="trip-card">
          <div class="subsection-header" onclick="toggleSubsection('packing')">
            <h3 class="subsection-title">ğŸ’ Packing Suggestions</h3>
            <span class="subsection-toggle" id="packing-toggle">â–¶</span>
          </div>
          <div class="subsection-content" id="packing-content">
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
            <div>
              <h4 style="color: var(--primary-color);">Clothing</h4>
              <ul style="margin-left: 20px; font-size: 0.95rem;">
                <li>Layers (mornings/evenings are cool)</li>
                <li>Comfortable hiking shoes</li>
                <li>Rain jacket</li>
                <li>Sun hat & sunglasses</li>
                <li>Casual evening wear</li>
              </ul>
            </div>
            <div>
              <h4 style="color: var(--primary-color);">Essentials</h4>
              <ul style="margin-left: 20px; font-size: 0.95rem;">
                <li>Sunscreen & bug spray</li>
                <li>Reusable water bottle</li>
                <li>Camera/phone charger</li>
                <li>Personal medications</li>
                <li>Toiletries</li>
              </ul>
            </div>
          </div>
          <p style="margin-top: 15px;"><em>Full packing list will be provided closer to trip date.</em></p>
          </div>
        </div>
        -->


      </div>
    </div>

  </div>

  <!-- Add/Edit Contact Modal -->
  <div class="modal" id="contactModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">Add Your Contact Info</h2>
        <button class="close-btn" onclick="closeModal()">&times;</button>
      </div>
      <form id="contactForm" onsubmit="submitContactToAdmin(event)">
        <input type="hidden" id="contactId">
        
        <div class="form-group">
          <label class="form-label" for="contactName">Name *</label>
          <input type="text" id="contactName" class="form-input" required placeholder="Enter your name">
        </div>

        <div class="form-group">
          <label class="form-label" for="contactEmail">Email *</label>
          <input type="email" id="contactEmail" class="form-input" required placeholder="your.email@example.com">
        </div>

        <div class="form-group">
          <label class="form-label" for="contactAddress">Street Address</label>
          <input type="text" id="contactAddress" class="form-input" placeholder="123 Main Street">
        </div>

        <div class="form-group">
          <label class="form-label" for="contactCity">City</label>
          <input type="text" id="contactCity" class="form-input" placeholder="City">
        </div>

        <div class="form-group">
          <label class="form-label" for="contactState">State</label>
          <input type="text" id="contactState" class="form-input" placeholder="State">
        </div>

        <div class="form-group">
          <label class="form-label" for="contactZip">ZIP Code</label>
          <input type="text" id="contactZip" class="form-input" placeholder="12345">
        </div>

        <div class="form-group">
          <label class="form-label" for="contactPhone">Phone Number</label>
          <input type="tel" id="contactPhone" class="form-input" placeholder="(555) 123-4567">
        </div>

        <div class="form-group">
          <label class="form-label" for="contactBirthday">Birthday (Month & Day)</label>
          <input type="text" id="contactBirthday" class="form-input" placeholder="MM/DD (e.g., 03/15)" pattern="(0[1-9]|1[0-2])/(0[1-9]|[12][0-9]|3[01])">
          <small style="color: var(--text-secondary); font-size: 0.85rem; margin-top: 5px; display: block;">Format: MM/DD (e.g., 03/15 for March 15th)</small>
        </div>

        <div class="action-buttons">
          <button type="submit" class="btn btn-primary">ğŸ“§ Submit</button>
          <button type="button" class="btn btn-secondary" onclick="closeModal()">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // Default contacts embedded in HTML
    const defaultContacts = [
      { id: 1, name: "Errin", email: "errinmccomb@gmail.com", address: "14 Coan Street", city: "Greenville", state: "SC", zip: "29617", phone: "", birthday: "" },
      { id: 2, name: "Melanie", email: "melaniebullock@yahoo.com", address: "3703 Burt Drive", city: "Raleigh", state: "NC", zip: "27606", phone: "", birthday: "" },
      { id: 3, name: "Summer", email: "summer0316@example.com", address: "2408 Dulair Road", city: "Greensboro", state: "NC", zip: "27407", phone: "", birthday: "" },
      { id: 4, name: "Dana", email: "missdana213@gmail.com", address: "8030 Stillmist Drive", city: "Fairburn", state: "Georgia", zip: "30213", phone: "", birthday: "" },
      { id: 5, name: "Vernet", email: "vernet1@gmail.com", address: "105 Shadburn Ferry Rd", city: "Buford", state: "GA", zip: "30518", phone: "", birthday: "" },
      { id: 6, name: "Monshaire", email: "mdfikes@gmail.com", address: "PO Box 6213", city: "Florence", state: "SC", zip: "29502", phone: "", birthday: "" },
      { id: 7, name: "Tamika F.", email: "tamikalfrancis@gmail.com", address: "225 Riverdell North Mews", city: "Lancaster", state: "TX", zip: "75146", phone: "", birthday: "" },
      { id: 8, name: "Tamika", email: "DST894@hotmail.com", address: "8304 Flat Keystone Drive", city: "Raleigh", state: "NC", zip: "", phone: "", birthday: "" },
      { id: 9, name: "Tephia Lindsay", email: "tephia25@yahoo.com", address: "8612-202 Olde Station Dr.", city: "Raleigh", state: "NC", zip: "27615", phone: "", birthday: "" },
      { id: 10, name: "Janita", email: "freshnclean9@gmail.com", address: "PO Box 415", city: "Wendell", state: "NC", zip: "27591", phone: "", birthday: "" },
      { id: 11, name: "Carolyn", email: "carolyn@example.com", address: "", city: "", state: "Texas", zip: "", phone: "", birthday: "" },
      { id: 12, name: "Sherri", email: "sherribelklaw@gmail.com", address: "143 Skylark Way", city: "Raleigh", state: "NC", zip: "27615", phone: "", birthday: "" },
      { id: 13, name: "Michelle", email: "michelleyfoxx@yahoo.com", address: "11682 Mustang Creek Ct", city: "Waldorf", state: "Maryland", zip: "20602", phone: "", birthday: "" },
      { id: 14, name: "Joeshun", email: "Joeshun@example.com", address: "", city: "", state: "", zip: "", phone: "", birthday: "" },
      { id: 15, name: "Nicole", email: "kilpatrickn39@gmail.com", address: "141 Bayleigh Court", city: "Garner", state: "NC", zip: "27529", phone: "", birthday: "" },
      { id: 16, name: "Rochelle", email: "iamadelta@yahoo.com", address: "9904 Orchard Grass Court", city: "Charlotte", state: "NC", zip: "28278", phone: "", birthday: "" }
    ];

    let contactsData = [];

    // Load contacts from JSON file
    async function initializeContacts() {
      try {
        const response = await fetch('contacts.json?t=' + Date.now()); // Cache-busting
        if (response.ok) {
          contactsData = await response.json();
          console.log('âœ… Loaded', contactsData.length, 'contacts from contacts.json');
        } else {
          throw new Error('contacts.json not found');
        }
      } catch (error) {
        console.error('âŒ Could not load contacts.json:', error.message);
        // Use default contacts as fallback
        contactsData = defaultContacts;
        console.log('ğŸ“‹ Using default contacts');
      }
      loadContacts();
    }

    // Load and display contacts
    function loadContacts() {
      const grid = document.getElementById('contacts-grid');
      
      // Use contactsData from JSON file
      if (!Array.isArray(contactsData) || contactsData.length === 0) {
        grid.innerHTML = '<p class="text-center">No contacts available.</p>';
        return;
      }

      grid.innerHTML = contactsData.map(contact => `
        <div class="contact-card">
          <div class="contact-name">${contact.name}</div>
          ${contact.birthday ? `<div class="contact-info">ğŸ‚ ${formatBirthday(contact.birthday)}</div>` : ''}
          ${contact.address ? `<div class="contact-info">ğŸ“ ${contact.address}</div>` : ''}
          ${contact.city || contact.state || contact.zip ? `<div class="contact-info">${[contact.city, contact.state, contact.zip].filter(Boolean).join(', ')}</div>` : ''}
          ${contact.phone ? `<div class="contact-info">ğŸ“ ${contact.phone}</div>` : ''}
          <div class="contact-info">
            <a href="mailto:${contact.email}" class="contact-email">âœ‰ï¸ ${contact.email}</a>
          </div>
          <div class="action-buttons">
            <button class="edit-btn" onclick="editContact(${contact.id})">âœï¸ Edit</button>
            <button class="delete-btn" onclick="deleteContact(${contact.id})">ğŸ—‘ï¸ Delete</button>
          </div>
        </div>
      `).join('');
    }

    // Format birthday for display
    function formatBirthday(birthday) {
      if (!birthday) return '';
      // Handle MM/DD format
      const parts = birthday.split('/');
      if (parts.length === 2) {
        const months = ['January', 'February', 'March', 'April', 'May', 'June',
                       'July', 'August', 'September', 'October', 'November', 'December'];
        const month = parseInt(parts[0]) - 1;
        const day = parseInt(parts[1]);
        if (month >= 0 && month < 12 && day >= 1 && day <= 31) {
          return `${months[month]} ${day}`;
        }
      }
      return birthday;
    }

    // Print page function
    function printPage() {
      // Expand all sections before printing
      const allContent = document.querySelectorAll('.subsection-content');
      const allIcons = document.querySelectorAll('.subsection-toggle');
      
      allContent.forEach(content => content.classList.add('expanded'));
      allIcons.forEach(icon => icon.classList.add('expanded'));
      
      // Wait a moment for sections to expand, then print
      setTimeout(() => {
        window.print();
      }, 300);
    }

    // Smooth scroll to section and expand it
    function scrollToSection(sectionId, event) {
      if (event) event.preventDefault();
      
      // Map of subsections to their parent sections
      const parentSections = {
        'estimates': 'trips',
        'lodging': 'trips',
        'roommate': 'trips',
        'actionitems': 'trips',
        'payment': 'trips',
        'activities': 'trips',
        'importantlinks': 'trips',
        'tripdetails': 'trips',
        'itinerary': 'trips',
        'packing': 'trips',
        'mytrip': 'trips',
        'decisions': 'trips'
      };
      
      // First, open parent section if this is a subsection
      if (parentSections[sectionId]) {
        const parentContent = document.getElementById(`${parentSections[sectionId]}-content`);
        if (parentContent && (!parentContent.style.display || parentContent.style.display === 'none')) {
          toggleSection(parentSections[sectionId]);
        }
      }
      
      // Now handle the target section
      let content = document.getElementById(`${sectionId}-content`);
      let icon = document.getElementById(`${sectionId}-toggle`) || document.getElementById(`${sectionId}-icon`);
      
      if (!content) {
        console.error(`Section ${sectionId}-content not found`);
        return;
      }
      
      // For main sections, use toggleSection
      if (sectionId === 'contacts' || sectionId === 'email' || sectionId === 'photos' || sectionId === 'trips') {
        if (!content.style.display || content.style.display === 'none') {
          toggleSection(sectionId);
        }
      } else {
        // For subsections, expand if not already expanded
        if (icon && !content.classList.contains('expanded')) {
          content.classList.add('expanded');
          icon.classList.add('expanded');
        }
      }
      
      // Smooth scroll to the section
      setTimeout(() => {
        content.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }, 200);
    }

    // Smooth scroll to a specific element (like a form)
    function scrollToElement(elementId, event) {
      if (event) event.preventDefault();
      
      const element = document.getElementById(elementId);
      if (!element) {
        console.error(`Element ${elementId} not found`);
        return;
      }
      
      // Open all parent <details> elements
      let currentElement = element;
      while (currentElement) {
        if (currentElement.tagName === 'DETAILS') {
          currentElement.setAttribute('open', '');
        }
        currentElement = currentElement.parentElement;
      }
      
      // Find and expand parent sections if needed
      let parent = element.closest('.subsection-content');
      if (parent) {
        // Get the subsection ID from the parent
        const subsectionId = parent.id.replace('-content', '');
        
        // Check if this subsection has a parent section
        const parentSections = {
          'estimates': 'trips',
          'decisions': 'trips',
          'lodging': 'trips',
          'roommate': 'trips',
          'actionitems': 'trips',
          'payment': 'trips',
          'activities': 'trips',
          'importantlinks': 'trips',
          'mytrip': 'trips',
          'tripdetails': 'trips',
          'itinerary': 'trips',
          'packing': 'trips'
        };
        
        // Open parent section first
        if (parentSections[subsectionId]) {
          const parentContent = document.getElementById(`${parentSections[subsectionId]}-content`);
          if (parentContent && (!parentContent.style.display || parentContent.style.display === 'none')) {
            toggleSection(parentSections[subsectionId]);
          }
        }
        
        // Then expand the subsection
        if (!parent.classList.contains('expanded')) {
          const icon = document.getElementById(`${subsectionId}-toggle`);
          parent.classList.add('expanded');
          if (icon) icon.classList.add('expanded');
        }
      }
      
      // Smooth scroll to the element
      setTimeout(() => {
        element.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }, 400);
    }

    // Open section and scroll to element
    function openSectionAndScroll(subsectionId, elementId, event) {
      if (event) event.preventDefault();
      
      // First, open the main "trips" section if it's not open
      const tripsContent = document.getElementById('trips-content');
      const tripsIcon = document.getElementById('trips-icon');
      if (tripsContent && !tripsContent.classList.contains('expanded')) {
        toggleSection('trips');
      }
      
      // Then open the subsection
      const subsectionContent = document.getElementById(`${subsectionId}-content`);
      const subsectionIcon = document.getElementById(`${subsectionId}-toggle`);
      if (subsectionContent && !subsectionContent.classList.contains('expanded')) {
        toggleSubsection(subsectionId);
      }
      
      // Open any parent <details> elements
      const element = document.getElementById(elementId);
      if (element) {
        let currentElement = element;
        while (currentElement) {
          if (currentElement.tagName === 'DETAILS') {
            currentElement.setAttribute('open', '');
          }
          currentElement = currentElement.parentElement;
        }
        
        // Scroll to the element after a short delay to allow sections to expand
        setTimeout(() => {
          element.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 400);
      }
    }

    // Download contacts as JSON file
    function downloadContactsJSON() {
      // Note: Contacts are loaded from JSON files, not localStorage
      alert('Contact data is managed by admin. Please request the JSON file from them.');
      return;
      const contacts = [];
      const dataStr = JSON.stringify(contacts, null, 2);
      const dataBlob = new Blob([dataStr], { type: 'application/json' });
      const url = URL.createObjectURL(dataBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'contacts.json';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
      
      alert('âœ… Contacts downloaded! Please send this file to the group admin to update the website.');
    }

    // Toggle section visibility
    function toggleSection(sectionId) {
      const content = document.getElementById(`${sectionId}-content`);
      const icon = document.getElementById(`${sectionId}-icon`);
      
      if (content.classList.contains('expanded')) {
        content.classList.remove('expanded');
        icon.classList.remove('expanded');
      } else {
        content.classList.add('expanded');
        icon.classList.add('expanded');
      }
    }

    // Toggle subsection visibility
    function toggleSubsection(subsectionId) {
      const content = document.getElementById(`${subsectionId}-content`);
      const icon = document.getElementById(`${subsectionId}-toggle`);
      
      if (content.classList.contains('expanded')) {
        content.classList.remove('expanded');
        icon.classList.remove('expanded');
      } else {
        content.classList.add('expanded');
        icon.classList.add('expanded');
      }
    }

    // Scroll to top of trip section
    function scrollToTop(event) {
      if (event) event.preventDefault();
      const header = document.getElementById('trip-section-header');
      if (header) {
        header.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }
    }

    // Collapse all sections
    function collapseAll() {
      // Collapse all main sections (contacts, email, photos, trips)
      const mainSections = ['contacts', 'email', 'photos', 'trips'];
      mainSections.forEach(sectionId => {
        const content = document.getElementById(`${sectionId}-content`);
        const icon = document.getElementById(`${sectionId}-icon`);
        if (content && content.classList.contains('expanded')) {
          content.classList.remove('expanded');
          if (icon) icon.classList.remove('expanded');
        }
      });

      // Collapse all subsection-content elements
      const allContent = document.querySelectorAll('.subsection-content');
      const allIcons = document.querySelectorAll('.subsection-toggle');
      
      allContent.forEach(content => {
        content.classList.remove('expanded');
      });
      
      allIcons.forEach(icon => {
        icon.classList.remove('expanded');
      });

      // Close all details elements (for collapsible maps and tent options)
      const allDetails = document.querySelectorAll('details');
      allDetails.forEach(detail => {
        detail.removeAttribute('open');
      });
    }

    // Open modal for adding contact
    function openAddContactModal() {
      document.getElementById('modalTitle').textContent = 'Add Your Contact Info';
      document.getElementById('contactForm').reset();
      document.getElementById('contactId').value = '';
      document.getElementById('contactModal').classList.add('active');
    }

    // Edit contact
    function editContact(id) {
      // Note: Contacts are loaded from JSON files, not localStorage
      alert('Contact editing must be done by admin. Please email them to update this contact.');
      return;
      const contacts = [];
      const contact = contacts.find(c => c.id === id);
      
      if (contact) {
        document.getElementById('modalTitle').textContent = 'Edit Contact Info';
        document.getElementById('contactId').value = contact.id;
        document.getElementById('contactName').value = contact.name;
        document.getElementById('contactEmail').value = contact.email;
        document.getElementById('contactAddress').value = contact.address || '';
        document.getElementById('contactCity').value = contact.city || '';
        document.getElementById('contactState').value = contact.state || '';
        document.getElementById('contactZip').value = contact.zip || '';
        document.getElementById('contactPhone').value = contact.phone || '';
        document.getElementById('contactBirthday').value = contact.birthday || '';
        document.getElementById('contactModal').classList.add('active');
      }
    }

    // Delete contact
    function deleteContact(id) {
      if (confirm('Are you sure you want to delete this contact?')) {
        // Note: Contacts are not stored locally - they are only in JSON files managed by admin
        alert('Contact deletion must be done by admin. Please email them to remove this contact.');
      }
    }

    // Save contact (no email)
    function saveContact(event) {
      event.preventDefault();
      
      // Note: Contacts are not stored locally
      const contacts = [];
      const id = document.getElementById('contactId').value;
      
      const contactData = {
        id: id ? parseInt(id) : Date.now(),
        name: document.getElementById('contactName').value,
        email: document.getElementById('contactEmail').value,
        address: document.getElementById('contactAddress').value,
        city: document.getElementById('contactCity').value,
        state: document.getElementById('contactState').value,
        zip: document.getElementById('contactZip').value,
        phone: document.getElementById('contactPhone').value,
        birthday: document.getElementById('contactBirthday').value
      };
      
      if (id) {
        // Update existing contact
        const index = contacts.findIndex(c => c.id === parseInt(id));
        if (index !== -1) {
          contacts[index] = contactData;
        }
      } else {
        // Add new contact
        contacts.push(contactData);
      }

      // Note: Data is NOT saved to localStorage - only sent to admin via email
      closeModal();
      loadContacts();
      
      alert('âœ… Contact saved locally!');
    }

    // Submit contact to admin (uses mailto as fallback)
    async function submitContactToAdmin(event) {
      event.preventDefault();
      
      // Get the current contact data from the form
      const contactData = {
        id: document.getElementById('contactId').value || Date.now(),
        name: document.getElementById('contactName').value,
        email: document.getElementById('contactEmail').value,
        address: document.getElementById('contactAddress').value,
        city: document.getElementById('contactCity').value,
        state: document.getElementById('contactState').value,
        zip: document.getElementById('contactZip').value,
        phone: document.getElementById('contactPhone').value,
        birthday: document.getElementById('contactBirthday').value
      };

      // Validate required fields
      if (!contactData.name || !contactData.email) {
        alert('âŒ Please fill in at least Name and Email before submitting.');
        return;
      }

      // Format contact info for email
      const contactInfo = `
Name: ${contactData.name}
Email: ${contactData.email}
Birthday: ${contactData.birthday || 'Not provided'}
Address: ${contactData.address || 'Not provided'}
City: ${contactData.city || 'Not provided'}
State: ${contactData.state || 'Not provided'}
ZIP: ${contactData.zip || 'Not provided'}
Phone: ${contactData.phone || 'Not provided'}
      `.trim();

      const contactJSON = JSON.stringify(contactData, null, 2);

      // Send via EmailJS with mailto fallback
      const submitBtn = event.target;
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = 'â³ Sending...';
      submitBtn.disabled = true;

      try {
        const result = await emailjs.send(
          'service_9sytocs',
          'template_fainkx7',
          {
            name: contactData.name,
            message: `Contact information has been updated:\n\n${contactInfo}\n\n---\nJSON Format:\n${contactJSON}`
          }
        );

        console.log('EmailJS Success:', result);
        alert('âœ… Contact information sent successfully to admin!');
        saveAndClose(contactData);
        
      } catch (error) {
        console.error('EmailJS Error Details:', error);
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        
        // Fallback to mailto
        if (confirm('Email service unavailable. Would you like to send via your email client instead?')) {
          const subject = `Spring 94 Contact Update: ${contactData.name}`;
          const body = `Contact information has been updated:\n\n${contactInfo}\n\n---\nJSON Format:\n${contactJSON}`;
          const mailtoLink = `mailto:dst894@hotmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
          window.location.href = mailtoLink;
          saveAndClose(contactData);
        }
      } finally {
        if (submitBtn.innerHTML === 'â³ Sending...') {
          submitBtn.innerHTML = originalText;
          submitBtn.disabled = false;
        }
      }
    }

    // Helper function to save and close modal
    function saveAndClose(contactData) {
      // Note: Contacts are not stored locally
      const contacts = [];
      const id = document.getElementById('contactId').value;
      
      if (id) {
        const index = contacts.findIndex(c => c.id === parseInt(id));
        if (index !== -1) {
          contacts[index] = contactData;
        }
      } else {
        contacts.push(contactData);
      }
      
      // Note: Data is NOT saved to localStorage - only sent to admin via email
      closeModal();
      loadContacts();
    }

    // Close modal
    function closeModal() {
      document.getElementById('contactModal').classList.remove('active');
      document.getElementById('contactForm').reset();
    }

    // Close modal when clicking outside
    document.getElementById('contactModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });

    // Load submitted roommates - disabled (data only in admin emails/JSON files)
    function loadSubmittedRoommates() {
      const submitted = [];
      const listContainer = document.getElementById('submittedRoommatesList');
      const section = document.getElementById('submittedRoommatesSection');
      
      if (submitted.length > 0 && section && listContainer) {
        section.style.display = 'block';
        listContainer.innerHTML = submitted.map((reservation, index) => `
          <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 15px; background: linear-gradient(135deg, #fff 0%, #f8f9fa 100%);">
            <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
              <h5 style="color: var(--primary-color); margin: 0;">${reservation.tentType}</h5>
              <button onclick="deleteReservation(${index})" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.9rem;">Delete</button>
            </div>
            <div style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 10px;">
              <strong>Confirmation:</strong> ${reservation.confirmationNumber}
            </div>
            <div style="display: grid; gap: 8px;">
              ${reservation.roommates.map((r, i) => `
                <div style="padding: 8px; background: white; border-radius: 5px; border-left: 3px solid var(--primary-color);">
                  <strong>${r.name}</strong>
                </div>
              `).join('')}
            </div>
            ${reservation.additionalNotes ? `<div style="margin-top: 10px; padding: 10px; background: #fff3cd; border-radius: 5px; font-size: 0.9rem;"><strong>Notes:</strong> ${reservation.additionalNotes}</div>` : ''}
          </div>
        `).join('');
      } else if (section) {
        section.style.display = 'none';
      }
    }

    // Delete reservation
    function deleteReservation(index) {
      if (confirm('Are you sure you want to delete this reservation?')) {
        // Note: Tentmate data is not stored locally - managed by admin
        alert('Tentmate deletion must be done by admin. Please email them to remove this reservation.');
      }
    }

    // Admin: Clear all reservations
    function clearAllReservations() {
      if (confirm('âš ï¸ Are you sure you want to delete ALL reservations? This cannot be undone!')) {
        // Note: Tentmate data is not stored locally - managed by admin
        alert('Tentmate data deletion must be done by admin. Please email them.');
        
        const messageDiv = document.getElementById('adminMessage');
        messageDiv.style.display = 'block';
        messageDiv.style.background = '#d4edda';
        messageDiv.style.color = '#155724';
        messageDiv.textContent = 'âœ… All reservations cleared successfully!';
        
        setTimeout(() => {
          messageDiv.style.display = 'none';
        }, 3000);
      }
    }

    // Admin: Add reservations from JSON (handles multiple objects)
    function addReservationsFromJson() {
      const jsonInput = document.getElementById('adminJsonInput').value.trim();
      const messageDiv = document.getElementById('adminMessage');
      
      if (!jsonInput) {
        messageDiv.style.display = 'block';
        messageDiv.style.background = '#fff3cd';
        messageDiv.style.color = '#856404';
        messageDiv.textContent = 'âš ï¸ Please paste JSON data first';
        return;
      }
      
      try {
        // Split by }{ to handle multiple JSON objects
        let jsonObjects = jsonInput.split(/\}\s*\{/);
        
        // Fix the split objects by adding back the braces
        if (jsonObjects.length > 1) {
          jsonObjects = jsonObjects.map((obj, index) => {
            if (index === 0) return obj + '}';
            if (index === jsonObjects.length - 1) return '{' + obj;
            return '{' + obj + '}';
          });
        }
        
        const submitted = [];
        let successCount = 0;
        let errors = [];
        
        // Process each JSON object
        jsonObjects.forEach((jsonStr, index) => {
          try {
            const reservationData = JSON.parse(jsonStr.trim());
            
            // Validate required fields
            if (!reservationData.confirmationNumber || !reservationData.tentType || !reservationData.roommates || reservationData.roommates.length === 0) {
              errors.push(`Object ${index + 1}: Missing required fields`);
              return;
            }
            
            // Add to array
            submitted.push(reservationData);
            successCount++;
            
          } catch (err) {
            errors.push(`Object ${index + 1}: ${err.message}`);
          }
        });
        
        // Note: Data is NOT saved to localStorage
        if (successCount > 0) {
        }
        
        // Show results
        messageDiv.style.display = 'block';
        if (errors.length === 0) {
          messageDiv.style.background = '#d4edda';
          messageDiv.style.color = '#155724';
          messageDiv.textContent = `âœ… Successfully added ${successCount} reservation${successCount > 1 ? 's' : ''}!`;
          document.getElementById('adminJsonInput').value = '';
        } else if (successCount > 0) {
          messageDiv.style.background = '#fff3cd';
          messageDiv.style.color = '#856404';
          messageDiv.textContent = `âš ï¸ Added ${successCount} reservation(s), but ${errors.length} failed:\n${errors.join('\n')}`;
        } else {
          messageDiv.style.background = '#f8d7da';
          messageDiv.style.color = '#721c24';
          messageDiv.textContent = `âŒ All reservations failed:\n${errors.join('\n')}`;
        }
        
        // Hide message after 5 seconds
        setTimeout(() => {
          messageDiv.style.display = 'none';
        }, 5000);
        
      } catch (error) {
        messageDiv.style.display = 'block';
        messageDiv.style.background = '#f8d7da';
        messageDiv.style.color = '#721c24';
        messageDiv.textContent = 'âŒ Error: ' + error.message + '. Please check the JSON format.';
      }
    }

    // Handle tentmate form submission
    document.getElementById('roommateForm')?.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      // Collect form data
      const formData = {
        confirmationNumber: document.getElementById('confirmationNumber').value,
        tentType: document.getElementById('tentType').value,
        roommates: [],
        additionalNotes: document.getElementById('additionalNotes').value,
        submittedDate: new Date().toISOString()
      };
      
      // Collect tentmate data
      for (let i = 1; i <= 4; i++) {
        const name = document.getElementById(`roommate${i}Name`).value;
        
        if (name) {
          formData.roommates.push({
            name: name
          });
        }
      }
      
      // Format roommate info for email
      const roommateInfo = `
Confirmation Number: ${formData.confirmationNumber}
Tent Type: ${formData.tentType}
Roommates: ${formData.roommates.map(r => r.name).join(', ')}
Additional Notes: ${formData.additionalNotes || 'None'}
Submitted: ${new Date(formData.submittedDate).toLocaleString()}
      `.trim();

      const roommateJSON = JSON.stringify(formData, null, 2);

      // Send via EmailJS
      const submitBtn = e.target.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = 'â³ Sending...';
      submitBtn.disabled = true;

      try {
        const result = await emailjs.send(
          'service_9sytocs',
          'template_fainkx7',
          {
            name: formData.roommates[0]?.name || 'Tentmate Submission',
            message: `Tentmates & Tent Reservation:\n\n${roommateInfo}\n\n---\nJSON Format:\n${roommateJSON}`
          }
        );

        console.log('âœ… Tentmate EmailJS Success:', result);
        console.log('Response details:', JSON.stringify(result, null, 2));
        
        // Note: Data is NOT saved to localStorage - only sent to admin via email

        alert('âœ… Your tentmate details have been sent to admin successfully!\n\nğŸ“Š Check the View Trip Dashboard in 24 hours for updates.');
        
        // Reset form and reload submitted list
        e.target.reset();
        loadSubmittedRoommates();
        
      } catch (error) {
        console.error('âŒ Tentmate EmailJS Error:', error);
        console.error('Error details:', JSON.stringify(error, null, 2));
        console.error('Error text:', error.text);
        console.error('Error status:', error.status);
        
        // Fallback to mailto
        if (confirm('Email service unavailable. Would you like to send via your email client instead?')) {
          const subject = `Tentmate Reservation: ${formData.confirmationNumber}`;
          const body = `Tentmates & Tent Reservation:\n\n${roommateInfo}\n\n---\nJSON Format:\n${roommateJSON}`;
          const mailtoLink = `mailto:dst894@hotmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
          window.location.href = mailtoLink;
          // Note: Data is NOT saved to localStorage - only sent to admin via email

          
          e.target.reset();
          loadSubmittedRoommates();
        }
      } finally {
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
      }
    });

    // Load submitted activities - disabled (data only in admin emails/JSON files)
    function loadSubmittedActivities() {
      let activities = [];
      
      // Ensure activities is an array
      if (!Array.isArray(activities)) {
        activities = [];
      }
      
      const section = document.getElementById('submittedActivitiesSection');
      const bozemanSection = document.getElementById('bozemanActivitiesSection');
      const yellowstoneSection = document.getElementById('yellowstoneActivitiesSection');
      const bozemanList = document.getElementById('bozemanActivitiesList');
      const yellowstoneList = document.getElementById('yellowstoneActivitiesList');
      
      // Check if elements exist before accessing them
      // Note: These sections were removed - user-submitted activities now go to dashboard
      if (!section || !bozemanSection || !yellowstoneSection || !bozemanList || !yellowstoneList) {
        // Silently return - these sections are intentionally removed
        return;
      }
      
      const bozemanActivities = activities.filter(a => a.location === 'bozeman');
      const yellowstoneActivities = activities.filter(a => a.location === 'yellowstone');
      
      if (activities.length > 0) {
        section.style.display = 'block';
        
        // Display Bozeman activities
        if (bozemanActivities.length > 0) {
          bozemanSection.style.display = 'block';
          bozemanList.innerHTML = bozemanActivities.map((activity, index) => `
            <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 15px; background: white;">
              <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                <h6 style="color: var(--primary-color); margin: 0;">${activity.name}</h6>
                <button onclick="deleteActivity(${activities.indexOf(activity)})" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.85rem;">Delete</button>
              </div>
              <p style="margin: 10px 0; color: var(--text-secondary);">${activity.description}</p>
              ${activity.cost ? `<div style="margin: 5px 0;"><strong>ğŸ’° Cost:</strong> ${activity.cost}</div>` : ''}
              ${activity.link ? `<div style="margin: 5px 0;"><strong>ğŸ”— Link:</strong> <a href="${activity.link}" target="_blank" style="color: var(--primary-color);">${activity.link}</a></div>` : ''}
              <div style="margin-top: 10px; font-size: 0.9rem; color: var(--text-secondary); font-style: italic;">
                Suggested by: ${activity.suggester}
              </div>
            </div>
          `).join('');
        } else {
          bozemanSection.style.display = 'none';
        }
        
        // Display Yellowstone activities
        if (yellowstoneActivities.length > 0) {
          yellowstoneSection.style.display = 'block';
          yellowstoneList.innerHTML = yellowstoneActivities.map((activity, index) => `
            <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 15px; background: white;">
              <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 10px;">
                <h6 style="color: var(--primary-color); margin: 0;">${activity.name}</h6>
                <button onclick="deleteActivity(${activities.indexOf(activity)})" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; font-size: 0.85rem;">Delete</button>
              </div>
              <p style="margin: 10px 0; color: var(--text-secondary);">${activity.description}</p>
              ${activity.cost ? `<div style="margin: 5px 0;"><strong>ğŸ’° Cost:</strong> ${activity.cost}</div>` : ''}
              ${activity.link ? `<div style="margin: 5px 0;"><strong>ğŸ”— Link:</strong> <a href="${activity.link}" target="_blank" style="color: var(--primary-color);">${activity.link}</a></div>` : ''}
              <div style="margin-top: 10px; font-size: 0.9rem; color: var(--text-secondary); font-style: italic;">
                Suggested by: ${activity.suggester}
              </div>
            </div>
          `).join('');
        } else {
          yellowstoneSection.style.display = 'none';
        }
      } else {
        section.style.display = 'none';
      }
    }

    // Delete activity
    function deleteActivity(index) {
      if (confirm('Are you sure you want to delete this activity suggestion?')) {
        // Note: Activity data is not stored locally - managed by admin
        alert('Activity deletion must be done by admin. Please email them to remove this suggestion.');
      }
    }

    // Initialize activity suggestions data
    let activitySuggestionsData = [];

    // Load activity suggestions from JSON file or use localStorage
    async function initializeActivitySuggestions() {
      try {
        const response = await fetch('activity_suggestions.json?t=' + Date.now()); // Cache-busting
        if (response.ok) {
          activitySuggestionsData = await response.json();
          // Save to localStorage with timestamp
          const dataWithTimestamp = {
            data: activitySuggestionsData,
            timestamp: Date.now(),
            source: 'activity_suggestions.json'
          };
          localStorage.setItem('submittedActivities', JSON.stringify(dataWithTimestamp));
          console.log('âœ… Loaded activity suggestions from activity_suggestions.json:', activitySuggestionsData.length, 'activities');
        } else {
          throw new Error('JSON file not found');
        }
      } catch (error) {
        console.warn('âš ï¸ Could not load activity_suggestions.json, using localStorage backup:', error.message);
        // Use localStorage as emergency backup
        const stored = localStorage.getItem('submittedActivities');
        if (stored) {
          try {
            const parsed = JSON.parse(stored);
            // Check if it's the new format with timestamp
            if (parsed.data && parsed.timestamp) {
              activitySuggestionsData = parsed.data;
              const age = Math.floor((Date.now() - parsed.timestamp) / (1000 * 60 * 60 * 24));
              console.log(`ğŸ“¦ Using cached activities from ${parsed.source} (${age} days old)`);
            } else {
              // Old format without timestamp
              activitySuggestionsData = parsed;
              console.log('ğŸ“¦ Using cached activities (unknown age)');
            }
          } catch (e) {
            activitySuggestionsData = [];
          }
        } else {
          activitySuggestionsData = [];
          console.log('ğŸ“‹ No activities available');
        }
      }
      loadSubmittedActivities();
      loadActivitiesExcursions(); // Load activities into the main section
    }

    // Load and display activities in the Activities & Excursions section
    function loadActivitiesExcursions() {
      const container = document.getElementById('activitiesListContainer');
      if (!container) return;

      if (!activitySuggestionsData || activitySuggestionsData.length === 0) {
        container.innerHTML = '<div style="text-align: center; padding: 40px; color: var(--text-secondary);"><p>No activities available yet. Check back soon!</p></div>';
        return;
      }

      // Get activity icon based on name/type
      function getActivityIcon(name) {
        const nameLower = name.toLowerCase();
        if (nameLower.includes('raft') || nameLower.includes('float')) return 'ğŸŒŠ';
        if (nameLower.includes('horse')) return 'ğŸ´';
        if (nameLower.includes('hike') || nameLower.includes('walk')) return 'ğŸ¥¾';
        if (nameLower.includes('tour') || nameLower.includes('yellowstone')) return 'ğŸ¦¬';
        if (nameLower.includes('photo')) return 'ğŸ“¸';
        if (nameLower.includes('hot spring') || nameLower.includes('soak')) return 'â™¨ï¸';
        if (nameLower.includes('cookout') || nameLower.includes('stagecoach')) return 'ğŸ¤ ';
        if (nameLower.includes('sunset') || nameLower.includes('butte')) return 'ğŸŒ…';
        return 'ğŸ¯';
      }

      // Separate activities by type
      const groupSelected = activitySuggestionsData.filter(a => a.selectedByGroup);
      const complimentaryActivities = activitySuggestionsData.filter(a => a.location === 'on-site' && !a.selectedByGroup);
      const otherActivities = activitySuggestionsData.filter(a => !a.selectedByGroup && a.location !== 'on-site');

      let html = '';

      // Show group-selected activities first
      if (groupSelected.length > 0) {
        html += `<div style="margin-bottom: 20px;"><h4 style="color: var(--primary-color); margin-bottom: 15px;">â­ Selected by Group</h4></div>`;
        
        groupSelected.forEach(activity => {
          const icon = getActivityIcon(activity.name);
          const locationText = activity.locationDetail || activity.location || '';
          const duration = activity.duration || '';
          const cost = activity.cost || 'TBD';
          const link = activity.link || '';
          
          html += `
            <div style="border: 2px solid var(--border-color); border-radius: 10px; padding: 15px; background: white; margin-bottom: 10px;">
              <h5 style="color: var(--primary-color); margin-bottom: 10px;">${icon} ${activity.name}</h5>
              <div style="display: grid; gap: 8px;">
                ${cost !== 'TBD' && cost !== '' ? `<div><strong>ğŸ’° Price:</strong> ${cost}</div>` : ''}
                ${duration ? `<div><strong>â±ï¸ Duration:</strong> ${duration}</div>` : ''}
                ${locationText ? `<div><strong>ğŸ“ Location:</strong> ${locationText}</div>` : ''}
                ${activity.description ? `<div style="margin-top: 5px; font-style: italic; color: var(--text-secondary);">${activity.description}</div>` : ''}
                ${link ? `<div style="margin-top: 8px;"><a href="${link}" target="_blank" rel="noopener" style="color: var(--primary-color); text-decoration: none; font-weight: 600;">ğŸ”— More Info</a></div>` : ''}
              </div>
            </div>
          `;
        });
      }

      // Show complimentary on-site activities in purple
      if (complimentaryActivities.length > 0) {
        if (groupSelected.length > 0) {
          html += `<div style="margin-top: 20px;"><h4 style="color: #8B5CF6; margin-bottom: 15px;">ğŸ Complimentary On-Site Activities</h4></div>`;
        } else {
          html += `<div style="margin-bottom: 20px;"><h4 style="color: #8B5CF6; margin-bottom: 15px;">ğŸ Complimentary On-Site Activities</h4></div>`;
        }
        
        complimentaryActivities.forEach(activity => {
          const icon = getActivityIcon(activity.name);
          const locationText = activity.locationDetail || activity.location || '';
          const duration = activity.duration || '';
          const cost = activity.cost || 'TBD';
          const link = activity.link || '';
          
          html += `
            <div style="border: 2px solid #8B5CF6; border-radius: 10px; padding: 15px; background: linear-gradient(to right, #F3E8FF, #FFFFFF); margin-bottom: 10px;">
              <h5 style="color: #8B5CF6; margin-bottom: 10px;">${icon} ${activity.name}</h5>
              <div style="display: grid; gap: 8px;">
                ${cost !== 'TBD' && cost !== '' ? `<div><strong>ğŸ’° Price:</strong> <span style="color: #8B5CF6; font-weight: bold;">${cost}</span></div>` : ''}
                ${duration ? `<div><strong>â±ï¸ Duration:</strong> ${duration}</div>` : ''}
                ${locationText ? `<div><strong>ğŸ“ Location:</strong> ${locationText}</div>` : ''}
                ${activity.description ? `<div style="margin-top: 5px; font-style: italic; color: #6B21A8;">${activity.description}</div>` : ''}
                ${link ? `<div style="margin-top: 8px;"><a href="${link}" target="_blank" rel="noopener" style="color: #8B5CF6; text-decoration: none; font-weight: 600;">ğŸ”— More Info</a></div>` : ''}
              </div>
            </div>
          `;
        });
      }

      // Show other activities
      if (otherActivities.length > 0) {
        if (groupSelected.length > 0 || complimentaryActivities.length > 0) {
          html += `<div style="margin-top: 20px;"><h4 style="color: var(--primary-color); margin-bottom: 15px;">Other Available Activities</h4></div>`;
        }
        
        otherActivities.forEach(activity => {
          const icon = getActivityIcon(activity.name);
          const locationText = activity.locationDetail || activity.location || '';
          const duration = activity.duration || '';
          const cost = activity.cost || 'TBD';
          const link = activity.link || '';
          
          // Check if activity is free
          const isFree = cost.toLowerCase().includes('free') || cost === '$0' || cost === '0';
          const borderColor = isFree ? '#14B8A6' : 'var(--border-color)';
          const backgroundColor = isFree ? 'linear-gradient(to right, #CCFBF1, #FFFFFF)' : 'white';
          const titleColor = isFree ? '#14B8A6' : 'var(--primary-color)';
          const costColor = isFree ? 'color: #14B8A6; font-weight: bold;' : '';
          
          html += `
            <div style="border: 2px solid ${borderColor}; border-radius: 10px; padding: 15px; background: ${backgroundColor}; margin-bottom: 10px;">
              <h5 style="color: ${titleColor}; margin-bottom: 10px;">${icon} ${activity.name}</h5>
              <div style="display: grid; gap: 8px;">
                ${cost !== 'TBD' && cost !== '' ? `<div><strong>ğŸ’° Price:</strong> <span style="${costColor}">${cost}</span></div>` : ''}
                ${duration ? `<div><strong>â±ï¸ Duration:</strong> ${duration}</div>` : ''}
                ${locationText ? `<div><strong>ğŸ“ Location:</strong> ${locationText}</div>` : ''}
                ${activity.description ? `<div style="margin-top: 5px; font-style: italic; color: var(--text-secondary);">${activity.description}</div>` : ''}
                ${link ? `<div style="margin-top: 8px;"><a href="${link}" target="_blank" rel="noopener" style="color: var(--primary-color); text-decoration: none; font-weight: 600;">ğŸ”— More Info</a></div>` : ''}
              </div>
            </div>
          `;
        });
      }

      container.innerHTML = html;
      console.log('âœ… Loaded', activitySuggestionsData.length, 'activities into Activities & Excursions section');
    }

    // Download activities list as a text file
    function downloadActivitiesList() {
      if (!activitySuggestionsData || activitySuggestionsData.length === 0) {
        alert('No activities available to download yet.');
        return;
      }

      // Separate activities by type
      const groupSelected = activitySuggestionsData.filter(a => a.selectedByGroup);
      const complimentaryActivities = activitySuggestionsData.filter(a => a.location === 'on-site' && !a.selectedByGroup);
      const otherActivities = activitySuggestionsData.filter(a => !a.selectedByGroup && a.location !== 'on-site');

      // Build the text content
      let content = 'ğŸ¯ ACTIVITIES & EXCURSIONS\n';
      content += 'Montana Glamping Adventure 2026\n';
      content += 'September 9-14, 2026\n';
      content += '=' .repeat(60) + '\n\n';

      // Group-selected activities
      if (groupSelected.length > 0) {
        content += 'â­ SELECTED BY GROUP\n';
        content += '-'.repeat(60) + '\n';
        groupSelected.forEach((activity, index) => {
          content += `\n${index + 1}. ${activity.name}\n`;
          if (activity.cost && activity.cost !== 'TBD') content += `   ğŸ’° Price: ${activity.cost}\n`;
          if (activity.duration) content += `   â±ï¸  Duration: ${activity.duration}\n`;
          if (activity.locationDetail || activity.location) content += `   ğŸ“ Location: ${activity.locationDetail || activity.location}\n`;
          if (activity.description) content += `   ğŸ“ ${activity.description}\n`;
          if (activity.link) content += `   ğŸ”— More Info: ${activity.link}\n`;
        });
        content += '\n';
      }

      // Complimentary activities
      if (complimentaryActivities.length > 0) {
        content += 'ğŸ COMPLIMENTARY ON-SITE ACTIVITIES\n';
        content += '-'.repeat(60) + '\n';
        complimentaryActivities.forEach((activity, index) => {
          content += `\n${index + 1}. ${activity.name}\n`;
          if (activity.cost && activity.cost !== 'TBD') content += `   ğŸ’° Price: ${activity.cost}\n`;
          if (activity.duration) content += `   â±ï¸  Duration: ${activity.duration}\n`;
          if (activity.locationDetail || activity.location) content += `   ğŸ“ Location: ${activity.locationDetail || activity.location}\n`;
          if (activity.description) content += `   ğŸ“ ${activity.description}\n`;
          if (activity.link) content += `   ğŸ”— More Info: ${activity.link}\n`;
        });
        content += '\n';
      }

      // Other activities
      if (otherActivities.length > 0) {
        content += 'OTHER AVAILABLE ACTIVITIES\n';
        content += '-'.repeat(60) + '\n';
        otherActivities.forEach((activity, index) => {
          content += `\n${index + 1}. ${activity.name}\n`;
          if (activity.cost && activity.cost !== 'TBD') content += `   ğŸ’° Price: ${activity.cost}\n`;
          if (activity.duration) content += `   â±ï¸  Duration: ${activity.duration}\n`;
          if (activity.locationDetail || activity.location) content += `   ğŸ“ Location: ${activity.locationDetail || activity.location}\n`;
          if (activity.description) content += `   ğŸ“ ${activity.description}\n`;
          if (activity.link) content += `   ğŸ”— More Info: ${activity.link}\n`;
        });
        content += '\n';
      }

      content += '=' .repeat(60) + '\n';
      content += `Total Activities: ${activitySuggestionsData.length}\n`;
      content += `Generated: ${new Date().toLocaleString()}\n`;

      // Create blob and download
      const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'Montana-Glamping-Activities-List.txt';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);

      console.log('âœ… Downloaded activities list');
    }

    // Handle activity suggestion form submission
    document.getElementById('activitySuggestionForm')?.addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const activityData = {
        location: document.getElementById('activityLocation').value,
        name: document.getElementById('activityName').value,
        description: document.getElementById('activityDescription').value,
        cost: document.getElementById('activityCost').value,
        link: document.getElementById('activityLink').value,
        suggester: document.getElementById('suggesterName').value,
        submittedDate: new Date().toISOString()
      };
      
      // Format activity info for email
      const activityInfo = `
Location: ${activityData.location === 'bozeman' ? 'ğŸ“ Bozeman Area' : 'ğŸï¸ Yellowstone Park Area'}
Activity Name: ${activityData.name}
Description: ${activityData.description}
Estimated Cost: ${activityData.cost || 'Not specified'}
Website/Link: ${activityData.link || 'Not provided'}
Suggested by: ${activityData.suggester}
Submitted: ${new Date(activityData.submittedDate).toLocaleString()}
      `.trim();

      const activityJSON = JSON.stringify(activityData, null, 2);

      // Send via EmailJS
      const submitBtn = e.target.querySelector('button[type="submit"]');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = 'â³ Sending...';
      submitBtn.disabled = true;

      try {
        const result = await emailjs.send(
          'service_9sytocs',
          'template_fainkx7',
          {
            name: activityData.suggester,
            message: `Activity Suggestion:\n\n${activityInfo}\n\n---\nJSON Format:\n${activityJSON}`
          }
        );

        console.log('EmailJS Success:', result);
        
        // Note: Data is NOT saved to localStorage - only sent to admin via email
        
        alert('âœ… Your activity suggestion has been sent to admin successfully!\n\nğŸ“Š Check the View Trip Dashboard in 24 hours for updates.');
        
        // Reset form
        e.target.reset();
        
      } catch (error) {
        console.error('EmailJS Error:', error);
        
        // Fallback to mailto
        if (confirm('Email service unavailable. Would you like to send via your email client instead?')) {
          const subject = `Activity Suggestion: ${activityData.name}`;
          const body = `Activity Suggestion:\n\n${activityInfo}\n\n---\nJSON Format:\n${activityJSON}`;
          const mailtoLink = `mailto:dst894@hotmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
          window.location.href = mailtoLink;
          
          // Note: Data is NOT saved to localStorage - only sent to admin via email
          
          e.target.reset();
        }
      } finally {
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
      }
    });


    // ===== TRIP DETAILS & ITINERARY FUNCTIONS =====
    
    // Populate name dropdown from whosgoing.json
    async function populateNameDropdown() {
      try {
        const timestamp = new Date().getTime();
        const response = await fetch(`whosgoing.json?t=${timestamp}`);
        const contacts = await response.json();
        const dropdown = document.getElementById('tripUserName');
        
        console.log('Fetching whosgoing.json for dropdown...', contacts);
        
        if (dropdown) {
          // Clear existing options except the first one
          dropdown.innerHTML = '<option value="">-- Select your name --</option>';
          
          // Add all contacts as options
          contacts.forEach(contact => {
            const option = document.createElement('option');
            option.value = contact.id;
            option.textContent = contact.name;
            option.dataset.email = contact.email;
            dropdown.appendChild(option);
          });
          
          // Add change event listener to store user ID and load existing data
          dropdown.addEventListener('change', async function() {
            const userId = parseInt(this.value);
            document.getElementById('tripUserId').value = userId;
            
            // Load existing trip details if available
            if (userId) {
              await loadExistingTripDetails(userId);
            }
          });
          
          console.log('âœ… Loaded', contacts.length, 'names into dropdown from whosgoing.json');
        } else {
          console.error('âŒ Dropdown element #tripUserName not found!');
        }
      } catch (error) {
        console.error('âŒ Error loading whosgoing.json for dropdown:', error);
      }
    }
    
    // Load existing trip details from tripcontacts.json
    async function loadExistingTripDetails(userId) {
      try {
        const timestamp = new Date().getTime();
        const response = await fetch(`tripcontacts.json?t=${timestamp}`);
        const tripContacts = await response.json();
        
        // Find the user's existing trip details
        const existingTrip = tripContacts.find(trip => trip.userId === userId);
        
        if (existingTrip) {
          console.log('âœ… Found existing trip details for user:', userId, existingTrip);
          
          // Populate outbound flight fields
          document.getElementById('outboundDepartureCity').value = existingTrip.outbound?.departureCity || '';
          document.getElementById('outboundArrivalCity').value = existingTrip.outbound?.arrivalCity || '';
          document.getElementById('outboundAirline').value = existingTrip.outbound?.airline || '';
          document.getElementById('outboundFlightNumber').value = existingTrip.outbound?.flightNumber || '';
          document.getElementById('outboundDeparture').value = existingTrip.outbound?.departure || '';
          document.getElementById('outboundArrival').value = existingTrip.outbound?.arrival || '';
          document.getElementById('outboundConfirmation').value = existingTrip.outbound?.confirmation || '';
          
          // Populate return flight fields
          document.getElementById('returnDepartureCity').value = existingTrip.return?.departureCity || '';
          document.getElementById('returnArrivalCity').value = existingTrip.return?.arrivalCity || '';
          document.getElementById('returnAirline').value = existingTrip.return?.airline || '';
          document.getElementById('returnFlightNumber').value = existingTrip.return?.flightNumber || '';
          document.getElementById('returnDeparture').value = existingTrip.return?.departure || '';
          document.getElementById('returnArrival').value = existingTrip.return?.arrival || '';
          document.getElementById('returnConfirmation').value = existingTrip.return?.confirmation || '';
          
          // Populate tent selection
          document.getElementById('selectedTent').value = existingTrip.tent?.type || '';
          document.getElementById('tentConfirmation').value = existingTrip.tent?.confirmation || '';
          document.getElementById('tentNotes').value = existingTrip.tent?.notes || '';
          
          // Populate transportation
          document.getElementById('needsAirportPickup').checked = existingTrip.transportation?.needsAirportPickup || false;
          document.getElementById('willingToRentCar').checked = existingTrip.transportation?.willingToRentCar || false;
          
          // Populate special requests
          document.getElementById('specialRequests').value = existingTrip.specialRequests || '';
          
          // Populate activities dropdown
          if (existingTrip.activities && existingTrip.activities.length > 0) {
            const dropdown = document.getElementById('tripActivitiesDropdown');
            if (dropdown) {
              // Clear all selections first
              Array.from(dropdown.options).forEach(option => option.selected = false);
              
              // Select the activities that match
              existingTrip.activities.forEach(activity => {
                Array.from(dropdown.options).forEach(option => {
                  try {
                    const optionData = JSON.parse(option.value);
                    if (optionData.name === activity.name) {
                      option.selected = true;
                    }
                  } catch (e) {
                    // Skip invalid options
                  }
                });
              });
            }
          }
          
          alert('âœ… Your previously submitted information has been loaded. You can now update any fields and resubmit.');
        } else {
          console.log('â„¹ï¸ No existing trip details found for user:', userId);
        }
      } catch (error) {
        console.error('Error loading existing trip details:', error);
        // Don't show error to user, just log it
      }
    }
    
    // Populate trip activities dropdown from activity_suggestions.json
    async function populateTripActivitiesDropdown() {
      try {
        const timestamp = new Date().getTime();
        const response = await fetch(`activity_suggestions.json?t=${timestamp}`);
        const activities = await response.json();
        const dropdown = document.getElementById('tripActivitiesDropdown');
        
        if (!dropdown) return;
        
        dropdown.innerHTML = '';
        
        // Separate group-selected and other activities
        const groupSelected = activities.filter(a => a.selectedByGroup);
        const otherActivities = activities.filter(a => !a.selectedByGroup);
        
        // Add group-selected activities first with special marker
        if (groupSelected.length > 0) {
          const groupOptgroup = document.createElement('optgroup');
          groupOptgroup.label = 'â­ Selected by Group (Example)';
          groupSelected.forEach((activity, index) => {
            const option = document.createElement('option');
            option.value = JSON.stringify({name: activity.name, cost: activity.cost, selectedByGroup: true});
            option.textContent = `${activity.name} - ${activity.cost}`;
            groupOptgroup.appendChild(option);
          });
          dropdown.appendChild(groupOptgroup);
        }
        
        // Add other activities
        if (otherActivities.length > 0) {
          const otherOptgroup = document.createElement('optgroup');
          otherOptgroup.label = 'Other Available Activities';
          otherActivities.forEach((activity, index) => {
            const option = document.createElement('option');
            option.value = JSON.stringify({name: activity.name, cost: activity.cost, selectedByGroup: false});
            option.textContent = `${activity.name} - ${activity.cost}`;
            otherOptgroup.appendChild(option);
          });
          dropdown.appendChild(otherOptgroup);
        }
        
        console.log('âœ… Loaded', activities.length, 'activities into dropdown');
        
      } catch (error) {
        console.error('Error loading activities for trip form:', error);
        const dropdown = document.getElementById('tripActivitiesDropdown');
        if (dropdown) {
          dropdown.innerHTML = '<option value="">Error loading activities</option>';
        }
      }
    }
    
    // Get selected activities from dropdown
    function getSelectedActivities() {
      const dropdown = document.getElementById('tripActivitiesDropdown');
      const selected = [];
      
      if (dropdown) {
        const selectedOptions = Array.from(dropdown.selectedOptions);
        selectedOptions.forEach(option => {
          try {
            const activityData = JSON.parse(option.value);
            selected.push(activityData);
          } catch (e) {
            console.error('Error parsing activity data:', e);
          }
        });
      }
      
      return selected;
    }
    
    // Populate activities dynamically from the Activities section
    function populateActivitiesCheckboxes() {
      const activitiesList = document.getElementById('activitiesCheckboxList');
      if (!activitiesList) return;

      // Define activities with their details (matching the Activities & Excursions section)
      const activities = [
        { id: 'rafting', name: 'Group Whitewater Rafting - 18 Mile', icon: 'ğŸŒŠ', price: '$164/person' },
        { id: 'float', name: 'Private Yellowstone River Luxury Float', icon: 'ğŸ›¶', price: '$644 total' },
        { id: 'horseback', name: 'Group Horseback Ride', icon: 'ğŸ´', price: '$244/person' },
        { id: 'park', name: 'Yellowstone Park Tours', icon: 'ğŸ¦¬', price: 'TBD' },
        { id: 'hiking', name: 'Hiking & Nature Walks', icon: 'ğŸ¥¾', price: 'Free' },
        { id: 'photo', name: 'Photography Tours', icon: 'ğŸ“¸', price: 'TBD' }
      ];

      activitiesList.innerHTML = activities.map(activity => `
        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
          <input type="checkbox" id="activity_${activity.id}" value="${activity.name}"
                 data-price="${activity.price}" style="width: 18px; height: 18px;">
          <span>${activity.icon} ${activity.name} (${activity.price})</span>
        </label>
      `).join('');
    }

    // Submit flight details to admin via email
    async function submitFlightDetails() {
      // Get user information
      const userNameDropdown = document.getElementById('tripUserName');
      const userId = document.getElementById('tripUserId').value;
      const userName = userNameDropdown.options[userNameDropdown.selectedIndex]?.text || '';
      
      // Validate user selection
      if (!userId || !userName) {
        alert('âŒ Please select your name from the dropdown first.');
        return;
      }
      
      const tripDetails = {
        userId: parseInt(userId),
        name: userName,
        outbound: {
          departureCity: document.getElementById('outboundDepartureCity').value,
          arrivalCity: document.getElementById('outboundArrivalCity').value,
          airline: document.getElementById('outboundAirline').value,
          flightNumber: document.getElementById('outboundFlightNumber').value,
          departure: document.getElementById('outboundDeparture').value,
          arrival: document.getElementById('outboundArrival').value,
          confirmation: document.getElementById('outboundConfirmation').value
        },
        return: {
          departureCity: document.getElementById('returnDepartureCity').value,
          arrivalCity: document.getElementById('returnArrivalCity').value,
          airline: document.getElementById('returnAirline').value,
          flightNumber: document.getElementById('returnFlightNumber').value,
          departure: document.getElementById('returnDeparture').value,
          arrival: document.getElementById('returnArrival').value,
          confirmation: document.getElementById('returnConfirmation').value
        },
        tent: {
          type: document.getElementById('selectedTent').value,
          confirmation: document.getElementById('tentConfirmation').value,
          notes: document.getElementById('tentNotes').value
        },
        activities: getSelectedActivities(),
        transportation: {
          needsAirportPickup: document.getElementById('needsAirportPickup').checked,
          needsAirportDropoff: document.getElementById('needsAirportDropoff').checked,
          willingToRentCar: document.getElementById('willingToRentCar').checked,
          arrivalTime: document.getElementById('outboundArrival').value,
          departureTime: document.getElementById('returnDeparture').value
        },
        specialRequests: document.getElementById('specialRequests').value,
        submittedDate: new Date().toISOString(),
        lastUpdated: new Date().toISOString(),
        confirmationStatus: 'pending'
      };

      // Validate at least flight info
      if (!tripDetails.outbound.airline && !tripDetails.return.airline) {
        alert('âŒ Please fill in at least some flight information before submitting.');
        return;
      }

      // Format flight info for email
      const formatDateTime = (dateStr) => {
        if (!dateStr) return 'Not specified';
        const date = new Date(dateStr);
        return date.toLocaleString('en-US', {
          weekday: 'short',
          month: 'short',
          day: 'numeric',
          year: 'numeric',
          hour: 'numeric',
          minute: '2-digit'
        });
      };

      // Format activities for email
      let activitiesText = 'None selected';
      if (tripDetails.activities && tripDetails.activities.length > 0) {
        const groupActivities = tripDetails.activities.filter(a => a.selectedByGroup);
        const otherActivities = tripDetails.activities.filter(a => !a.selectedByGroup);
        
        activitiesText = '';
        if (groupActivities.length > 0) {
          activitiesText += '\n  â­ GROUP SELECTED:\n';
          groupActivities.forEach(a => {
            activitiesText += `    - ${a.name} (${a.cost})\n`;
          });
        }
        if (otherActivities.length > 0) {
          activitiesText += '\n  ADDITIONAL ACTIVITIES:\n';
          otherActivities.forEach(a => {
            activitiesText += `    - ${a.name} (${a.cost})\n`;
          });
        }
      }

      const flightInfo = `
OUTBOUND FLIGHT:
  From: ${tripDetails.outbound.departureCity || 'Not specified'}
  To: ${tripDetails.outbound.arrivalCity || 'Not specified'}
  Airline: ${tripDetails.outbound.airline || 'Not specified'}
  Flight #: ${tripDetails.outbound.flightNumber || 'Not specified'}
  Departure: ${formatDateTime(tripDetails.outbound.departure)}
  Arrival: ${formatDateTime(tripDetails.outbound.arrival)}
  Confirmation: ${tripDetails.outbound.confirmation || 'Not specified'}

RETURN FLIGHT:
  From: ${tripDetails.return.departureCity || 'Not specified'}
  To: ${tripDetails.return.arrivalCity || 'Not specified'}
  Airline: ${tripDetails.return.airline || 'Not specified'}
  Flight #: ${tripDetails.return.flightNumber || 'Not specified'}
  Departure: ${formatDateTime(tripDetails.return.departure)}
  Arrival: ${formatDateTime(tripDetails.return.arrival)}
  Confirmation: ${tripDetails.return.confirmation || 'Not specified'}

TENT: ${tripDetails.tent.type || 'Not selected'}${tripDetails.tent.notes ? `\nNotes: ${tripDetails.tent.notes}` : ''}

ACTIVITIES INTERESTED IN:${activitiesText}

TRANSPORTATION:
  Needs Airport Pickup: ${tripDetails.transportation.needsAirportPickup ? 'Yes' : 'No'}
  Needs Airport Dropoff: ${tripDetails.transportation.needsAirportDropoff ? 'Yes' : 'No'}
  Willing to Drive Rental Car/Van: ${tripDetails.transportation.willingToRentCar ? 'Yes' : 'No'}

SPECIAL REQUESTS: ${tripDetails.specialRequests || 'None'}
      `.trim();

      const flightJSON = JSON.stringify(tripDetails, null, 2);

      // Send via EmailJS
      const submitBtn = event.target;
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = 'â³ Sending...';
      submitBtn.disabled = true;

      try {
        const result = await emailjs.send(
          'service_9sytocs',
          'template_fainkx7',
          {
            name: tripDetails.name,
            message: `Flight & Trip Details:\n\n${flightInfo}\n\n---\nJSON Format:\n${flightJSON}`
          }
        );

        console.log('EmailJS Success:', result);
        
        // Note: Data is NOT saved to localStorage - only sent to admin via email
        // This prevents cross-device confusion and ensures admin has the authoritative data
        
        alert('âœ… Your flight and trip details have been sent to admin successfully!\n\nğŸ“Š Check the View Trip Dashboard in 24 hours for updates.');
        
      } catch (error) {
        console.error('EmailJS Error:', error);
        
        // Fallback to mailto
        if (confirm('Email service unavailable. Would you like to send via your email client instead?')) {
          const subject = `Flight Details: ${tripDetails.name}`;
          const body = `Flight & Trip Details:\n\n${flightInfo}\n\n---\nJSON Format:\n${flightJSON}`;
          const mailtoLink = `mailto:dst894@hotmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
          window.location.href = mailtoLink;
          
          // Note: Data is NOT saved to localStorage - only sent to admin via email
        }
      } finally {
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
      }
    }

    function saveTripDetails() {
      const tripDetails = {
        outbound: {
          departureCity: document.getElementById('outboundDepartureCity').value,
          arrivalCity: document.getElementById('outboundArrivalCity').value,
          airline: document.getElementById('outboundAirline').value,
          flightNumber: document.getElementById('outboundFlightNumber').value,
          departure: document.getElementById('outboundDeparture').value,
          arrival: document.getElementById('outboundArrival').value,
          confirmation: document.getElementById('outboundConfirmation').value
        },
        return: {
          departureCity: document.getElementById('returnDepartureCity').value,
          arrivalCity: document.getElementById('returnArrivalCity').value,
          airline: document.getElementById('returnAirline').value,
          flightNumber: document.getElementById('returnFlightNumber').value,
          departure: document.getElementById('returnDeparture').value,
          arrival: document.getElementById('returnArrival').value,
          confirmation: document.getElementById('returnConfirmation').value
        },
        tent: {
          type: document.getElementById('selectedTent').value,
          confirmation: document.getElementById('tentConfirmation').value,
          notes: document.getElementById('tentNotes').value
        },
        activities: [],
        emergency: {
          name: document.getElementById('emergencyName').value,
          phone: document.getElementById('emergencyPhone').value,
          relationship: document.getElementById('emergencyRelationship').value
        }
      };

      // Collect selected activities with their prices
      const activityCheckboxes = document.querySelectorAll('[id^="activity_"]');
      activityCheckboxes.forEach(checkbox => {
        if (checkbox.checked) {
          tripDetails.activities.push({
            name: checkbox.value,
            price: checkbox.getAttribute('data-price')
          });
        }
      });

      // Note: Data is NOT saved to localStorage for download itinerary
      // Download generates from current form values only
      
      alert('âœ… Your itinerary has been downloaded successfully!');
    }

    function loadTripDetails() {
      // Note: This function no longer loads from localStorage
      // Form starts empty each time to avoid cross-device confusion
      const saved = null; // Disabled localStorage loading
      if (!saved) return;

      const tripDetails = JSON.parse(saved);

      // Load outbound flight
      if (tripDetails.outbound) {
        if (document.getElementById('outboundDepartureCity'))
          document.getElementById('outboundDepartureCity').value = tripDetails.outbound.departureCity || '';
        if (document.getElementById('outboundArrivalCity'))
          document.getElementById('outboundArrivalCity').value = tripDetails.outbound.arrivalCity || '';
        document.getElementById('outboundAirline').value = tripDetails.outbound.airline || '';
        document.getElementById('outboundFlightNumber').value = tripDetails.outbound.flightNumber || '';
        document.getElementById('outboundDeparture').value = tripDetails.outbound.departure || '';
        document.getElementById('outboundArrival').value = tripDetails.outbound.arrival || '';
        document.getElementById('outboundConfirmation').value = tripDetails.outbound.confirmation || '';
      }

      // Load return flight
      if (tripDetails.return) {
        if (document.getElementById('returnDepartureCity'))
          document.getElementById('returnDepartureCity').value = tripDetails.return.departureCity || '';
        if (document.getElementById('returnArrivalCity'))
          document.getElementById('returnArrivalCity').value = tripDetails.return.arrivalCity || '';
        document.getElementById('returnAirline').value = tripDetails.return.airline || '';
        document.getElementById('returnFlightNumber').value = tripDetails.return.flightNumber || '';
        document.getElementById('returnDeparture').value = tripDetails.return.departure || '';
        document.getElementById('returnArrival').value = tripDetails.return.arrival || '';
        document.getElementById('returnConfirmation').value = tripDetails.return.confirmation || '';
      }

      // Load tent selection
      if (tripDetails.tent) {
        if (typeof tripDetails.tent === 'string') {
          // Old format compatibility
          document.getElementById('selectedTent').value = tripDetails.tent;
        } else {
          document.getElementById('selectedTent').value = tripDetails.tent.type || '';
          if (document.getElementById('tentConfirmation'))
            document.getElementById('tentConfirmation').value = tripDetails.tent.confirmation || '';
          if (document.getElementById('tentNotes'))
            document.getElementById('tentNotes').value = tripDetails.tent.notes || '';
        }
      }

      // Load activities
      if (tripDetails.activities) {
        tripDetails.activities.forEach(activity => {
          const activityName = typeof activity === 'string' ? activity : activity.name;
          const checkbox = Array.from(document.querySelectorAll('[id^="activity_"]'))
            .find(cb => cb.value === activityName);
          if (checkbox) checkbox.checked = true;
        });
      }

      // Load emergency contact
      if (tripDetails.emergency) {
        document.getElementById('emergencyName').value = tripDetails.emergency.name || '';
        document.getElementById('emergencyPhone').value = tripDetails.emergency.phone || '';
        document.getElementById('emergencyRelationship').value = tripDetails.emergency.relationship || '';
      }
    }

    async function downloadTripItinerary() {
      // Get the selected user ID from the dropdown
      const userId = document.getElementById('tripUserId').value;
      const userName = document.getElementById('tripUserName').options[document.getElementById('tripUserName').selectedIndex]?.text;
      
      if (!userId || !userName) {
        alert('âš ï¸ Please select your name from the dropdown first!');
        return;
      }

      try {
        // Fetch user's trip details from tripcontacts.json
        const timestamp = new Date().getTime();
        const response = await fetch(`tripcontacts.json?t=${timestamp}`);
        const tripContacts = await response.json();
        const tripDetails = tripContacts.find(tc => tc.userId === parseInt(userId));
        
        if (!tripDetails) {
          alert('âš ï¸ No trip details found. Please fill out and submit the form first!');
          return;
        }
        
        // Fetch group-selected activities from activity_suggestions.json
        const activityResponse = await fetch(`activity_suggestions.json?t=${timestamp}`);
        const allActivities = await activityResponse.json();
        const groupActivities = allActivities.filter(a => a.selectedByGroup);
        
        // Ensure all required properties exist with defaults
        if (!tripDetails.activities) tripDetails.activities = [];
        if (!tripDetails.outbound) tripDetails.outbound = {};
        if (!tripDetails.return) tripDetails.return = {};
        if (!tripDetails.emergency) tripDetails.emergency = {};
        if (!tripDetails.tent) tripDetails.tent = {};
      
        // Format dates nicely
        const formatDateTime = (dateStr) => {
        if (!dateStr) return 'Not specified';
        const date = new Date(dateStr);
        return date.toLocaleString('en-US', { 
          weekday: 'short', 
          month: 'short', 
          day: 'numeric', 
          year: 'numeric',
          hour: 'numeric',
          minute: '2-digit',
          hour12: true
        });
        };

        // Create document content
        let content = `DOTS GO GLAMPING - YELLOWSTONE 2026
Personal Trip Itinerary for ${userName}
Generated: ${new Date().toLocaleDateString()}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TRIP OVERVIEW
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
Dates: September 9-13, 2026
Location: Under Canvas Yellowstone, Montana
Trip Coordinators: Sherri Belk & Janita Moody

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FLIGHT INFORMATION
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

OUTBOUND FLIGHT
  From: ${tripDetails.outbound.departureCity || 'Not specified'}
  To: ${tripDetails.outbound.arrivalCity || 'Not specified'}
  Airline: ${tripDetails.outbound.airline || 'Not specified'}
  Flight Number: ${tripDetails.outbound.flightNumber || 'Not specified'}
  Departure: ${formatDateTime(tripDetails.outbound.departure)}
  Arrival: ${formatDateTime(tripDetails.outbound.arrival)}
  Confirmation: ${tripDetails.outbound.confirmation || 'Not specified'}

RETURN FLIGHT
  From: ${tripDetails.return.departureCity || 'Not specified'}
  To: ${tripDetails.return.arrivalCity || 'Not specified'}
  Airline: ${tripDetails.return.airline || 'Not specified'}
  Flight Number: ${tripDetails.return.flightNumber || 'Not specified'}
  Departure: ${formatDateTime(tripDetails.return.departure)}
  Arrival: ${formatDateTime(tripDetails.return.arrival)}
  Confirmation: ${tripDetails.return.confirmation || 'Not specified'}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ACCOMMODATION DETAILS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ACCOMMODATION SCHEDULE (In Chronological Order)

Night 1 (Sept 9-10):
  Home2 Suites by Hilton Bozeman
  Address: 5320 Tschache Ln, Bozeman, MT 59718
  Phone: (406) 582-8800
  Check-in: 3:00 PM | Check-out: 11:00 AM

Nights 2-3 (Sept 10-12):
  Under Canvas North Yellowstone â€“ Paradise Valley
  Address: 139 Pine Creek Road, Livingston, Montana 59047
  Phone: (888) 496-1148
  Check-in: 4:00 PM | Check-out: 11:00 AM
  â›º GLAMPING EXPERIENCE

Night 4 (Sept 12-13):
  Home2 Suites by Hilton Belgrade
  Address: 6261 Jackrabbit Ln, Belgrade, MT 59714
  Phone: (406) 813-3000
  Check-in: 3:00 PM | Check-out: 11:00 AM

MY TENT SELECTION
  Type: ${tripDetails.tent?.type || tripDetails.tent || 'Not selected yet'}
  Confirmation Number: ${tripDetails.tent?.confirmation || 'Not provided'}
  Notes: ${tripDetails.tent?.notes || 'None'}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ACTIVITIES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â­ SELECTED BY GROUP (For Everyone):
${groupActivities.length > 0 ?
  groupActivities.map(a => `  â­ ${a.name} - ${a.cost}`).join('\n')
: '  No group activities selected yet'}

MY SELECTED ACTIVITIES:
${tripDetails.activities && tripDetails.activities.length > 0 ?
  tripDetails.activities.map(a => {
    const activityName = typeof a === 'string' ? a : (a && a.name ? a.name : 'Unknown activity');
    const activityPrice = typeof a === 'string' ? '' : (a && a.cost ? ` - ${a.cost}` : '');
    return `  âœ“ ${activityName}${activityPrice}`;
  }).join('\n')
: '  No personal activities selected yet'}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TRIP COORDINATORS CONTACT
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  Sherri Belk: sherribelklaw@gmail.com
  Janita Moody: freshnclean9@gmail.com

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ’° PERSONAL COST BREAKDOWN - COMING SOON!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
A detailed cost breakdown section will be added here soon to help you
track your trip expenses including flights, accommodations, activities,
and other costs. Stay tuned!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

IMPORTANT REMINDERS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  â€¢ Bring valid ID for flights and hotel check-in
  â€¢ Pack layers - Montana weather can be unpredictable
  â€¢ Bring sunscreen, bug spray, and comfortable shoes
  â€¢ Camera/phone for capturing memories
  â€¢ Reusable water bottle
  â€¢ Any personal medications

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Have an amazing trip! ğŸ•ï¸âœ¨

For the latest updates, visit:
https://tamimoooo.github.io/agenda/reunion.html
`;

        // Create and download the file
        const blob = new Blob([content], { type: 'text/plain' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `Yellowstone_Trip_Itinerary_${userName.replace(/\s+/g, '_')}_2026.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);

        alert('ğŸ“¥ Your trip itinerary has been downloaded!\n\nNote: This is a text file mockup. In the full version, this would be a formatted Word document (.docx) with proper styling, images, and layout.');
      } catch (error) {
        console.error('Error downloading itinerary:', error);
        alert('âŒ Error downloading itinerary. Please try again.');
      }
    }

    // Countdown Timer Function
    function updateCountdown() {
      const reunionDate = new Date('September 9, 2026 00:00:00').getTime();
      const now = new Date().getTime();
      const distance = reunionDate - now;

      const daysElement = document.getElementById('days');
      
      if (!daysElement) {
        console.error('Countdown element not found');
        return;
      }

      if (distance < 0) {
        document.getElementById('countdown').innerHTML = '<div style="font-size: 1.5rem; font-weight: bold;">ğŸ‰ The Adventure Has Begun! ğŸ‰</div>';
        return;
      }

      const days = Math.floor(distance / (1000 * 60 * 60 * 24));

      daysElement.textContent = days;
      
      console.log(`Countdown updated: ${days} days`);
    }

    // Toggle Questions Form visibility
    function toggleQuestionsForm() {
      const content = document.getElementById('questionsFormContent');
      const toggle = document.getElementById('questionsToggle');
      
      if (content.style.display === 'none' || content.style.display === '') {
        content.style.display = 'block';
        toggle.style.transform = 'rotate(90deg)';
        toggle.textContent = 'â–¼';
      } else {
        content.style.display = 'none';
        toggle.style.transform = 'rotate(0deg)';
        toggle.textContent = 'â–¶';
      }
    }

    // Handle Questions Form Submission
    async function handleQuestionsSubmit(event) {
      event.preventDefault();
      
      const form = document.getElementById('questionsForm');
      const submitBtn = form.querySelector('button[type="submit"]');
      const statusDiv = document.getElementById('questionStatus');
      const originalBtnText = submitBtn.innerHTML;
      
      // Get form values
      const name = document.getElementById('questionName').value.trim();
      const email = document.getElementById('questionEmail').value.trim();
      const question = document.getElementById('questionText').value.trim();
      
      // Validate
      if (!name || !email || !question) {
        statusDiv.style.display = 'block';
        statusDiv.style.background = '#ffebee';
        statusDiv.style.color = '#c62828';
        statusDiv.innerHTML = 'âŒ Please fill in all required fields.';
        return;
      }
      
      // Disable button and show loading
      submitBtn.disabled = true;
      submitBtn.innerHTML = 'â³ Sending...';
      statusDiv.style.display = 'none';
      
      try {
        // Send email via EmailJS
        // Note: EmailJS template should include cc_email parameter for BCC functionality
        const result = await emailjs.send(
          'service_9sytocs',
          'template_fainkx7',
          {
            name: name,
            from_email: email,
            message: `Question submitted by ${name} (${email}):\n\n${question}`,
            cc_email: 'dst894@hotmail.com,sherribelklaw@gmail.com,freshnclean9@gmail.com'
          }
        );
        
        console.log('âœ… Question submitted successfully:', result);
        console.log('Response details:', JSON.stringify(result, null, 2));
        
        // Show success message
        statusDiv.style.display = 'block';
        statusDiv.style.background = '#e8f5e9';
        statusDiv.style.color = '#2e7d32';
        statusDiv.innerHTML = 'âœ… Your question has been submitted successfully! We\'ll address it at the meeting.';
        
        // Reset form
        form.reset();
        
        // Re-enable button
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
        
      } catch (error) {
        console.error('âŒ Error submitting question:', error);
        console.error('Error details:', JSON.stringify(error, null, 2));
        console.error('Error text:', error.text);
        console.error('Error status:', error.status);
        
        // Show error message
        statusDiv.style.display = 'block';
        statusDiv.style.background = '#ffebee';
        statusDiv.style.color = '#c62828';
        statusDiv.innerHTML = 'âŒ Failed to submit question. Please try again or email directly to dst894@hotmail.com';
        
        // Re-enable button
        submitBtn.disabled = false;
        submitBtn.innerHTML = originalBtnText;
      }
    }

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      initializeContacts();
      initializeActivitySuggestions();
      populateActivitiesCheckboxes();
      populateNameDropdown();
      populateTripActivitiesDropdown();
      loadTripDetails();
      
      // Initialize questions form
      const questionsForm = document.getElementById('questionsForm');
      if (questionsForm) {
        questionsForm.addEventListener('submit', handleQuestionsSubmit);
      }
      
      // All sections start collapsed (no auto-expand)

      // Handle URL hash navigation (for shareable links)
      if (window.location.hash) {
        const hash = window.location.hash.substring(1); // Remove the # symbol
        
        // Wait a moment for page to fully load, then navigate to section
        setTimeout(() => {
          // Check if it's a subsection (ends with -content)
          if (hash.endsWith('-content')) {
            const sectionId = hash.replace('-content', '');
            scrollToSection(sectionId);
          }
          // Check if it's a specific element (like bookYourTent)
          else {
            const element = document.getElementById(hash);
            if (element) {
              element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
          }
        }, 500); // Small delay to ensure all content is loaded
      }

      // Load saved trip details on page load
      loadTripDetails();
      
      // Start countdown timer immediately and update every minute for testing
      setTimeout(updateCountdown, 100); // Small delay to ensure DOM is ready
      setInterval(updateCountdown, 60000); // Update every minute
    });
  </script>
</body>
</html>












